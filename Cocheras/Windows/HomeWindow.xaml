<Window x:Class="Cocheras.Windows.HomeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Sistema de Estacionamiento"
        Icon="pack://application:,,,/Assets/Images/logo.png"
        WindowState="Maximized"
        WindowStyle="None"
        ResizeMode="NoResize"
        Background="#F9FAFB"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Primera franja horizontal - Menú principal -->
        <Border Grid.Row="0" 
                x:Name="HeaderPrincipal"
                Background="#1E3A8A" 
                Height="65"
                Padding="20,0">
            <Grid x:Name="BarraFiltros">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Inicio -->
                <Button Grid.Column="0" 
                        x:Name="BtnInicio" 
                        Content="Inicio" 
                        Height="40"
                        Width="90"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Background="#3B82F6"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Cursor="Hand"
                        Click="BtnInicio_Click"/>

                <!-- Mensuales -->
                <Button Grid.Column="1" 
                        x:Name="BtnMensuales" 
                        Content="Mensuales" 
                        Height="40"
                        Width="110"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Cursor="Hand"
                        Click="BtnMensuales_Click"/>

                <!-- Caja -->
                <Button Grid.Column="2" 
                        x:Name="BtnCaja" 
                        Content="$ Caja" 
                        Height="40"
                        Width="90"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Cursor="Hand"
                        Click="BtnCaja_Click"/>

                <!-- Configuración -->
                <Button Grid.Column="3" 
                        x:Name="BtnConfiguracion" 
                        Content="Configuración" 
                        Height="40"
                        Width="130"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Cursor="Hand"
                        Click="BtnConfiguracion_Click"/>

                <!-- Espacio -->
                <Grid Grid.Column="4"/>

                <!-- Simular Tarifas -->
                <Button Grid.Column="5" 
                        x:Name="BtnSimularTarifas" 
                        Content="Simulador de Tarifas" 
                        Height="40"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,15,0"
                        Cursor="Hand"
                        Click="BtnSimularTarifas_Click"/>

                <!-- Nombre Usuario con menú desplegable -->
                <StackPanel Grid.Column="6" 
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            Margin="0,0,20,0"
                            Cursor="Hand"
                            MouseLeftButtonUp="PanelUsuario_MouseLeftButtonUp">
                    <TextBlock x:Name="TxtNombreUsuario" 
                               Text="Usuario"
                               FontSize="14"
                               Foreground="White"
                               VerticalAlignment="Center"/>
                    <Path x:Name="TrianguloUsuario"
                          Data="M 0 0 L 5 5 L 10 0 Z"
                          Fill="White"
                          Stretch="Uniform"
                          Width="10"
                          Height="6"
                          Margin="5,0,0,0"
                          VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Hora -->
                <TextBlock Grid.Column="8" 
                           x:Name="TxtHora" 
                           Text="00:00:00"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="White"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Segunda franja - Submenú (solo visible en Inicio) -->
        <Border Grid.Row="1" 
                x:Name="PanelSubmenu"
                Background="#F8FAFC" 
                Height="55"
                Padding="20,0"
                BorderBrush="#E5E7EB"
                BorderThickness="0,0,0,1"
                x:FieldModifier="public">
            <StackPanel Orientation="Horizontal">
                <!-- Tickets Abiertos (seleccionado) -->
                <Button x:Name="BtnTicketsAbiertos" 
                        Content="Tickets Abiertos" 
                        Height="42"
                        Width="150"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="#3B82F6"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnTicketsAbiertos_Click"/>

                <!-- Tickets Cerrados -->
                <Button x:Name="BtnTicketsCerrados" 
                        Content="Tickets Cerrados" 
                        Height="42"
                        Width="150"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnTicketsCerrados_Click"/>

                <!-- Entradas/Salidas -->
                <Button x:Name="BtnEntradasSalidas" 
                        Content="Entradas / Salidas" 
                        Height="42"
                        Width="160"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnEntradasSalidas_Click"/>

                <!-- Reportes -->
                <Button x:Name="BtnReportes" 
                        Content="Reportes" 
                        Height="42"
                        Width="110"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnReportes_Click"/>

                <!-- Informes -->
                <Button x:Name="BtnInformes" 
                        Content="Informes" 
                        Height="42"
                        Width="110"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnInformes_Click"/>

                <!-- Estadísticas -->
                <Button x:Name="BtnEstadisticas" 
                        Content="Estadísticas" 
                        Height="42"
                        Width="130"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="BtnEstadisticas_Click"/>
            </StackPanel>
        </Border>

        <!-- Segunda franja - Submenú Configuración -->
        <Border Grid.Row="1" 
                x:Name="PanelSubmenuConfiguracion"
                Background="#F8FAFC" 
                Height="55"
                Padding="20,0"
                BorderBrush="#E5E7EB"
                BorderThickness="0,0,0,1"
                Visibility="Collapsed"
                x:FieldModifier="public">
            <StackPanel Orientation="Horizontal">
                <!-- Categorías -->
                <Button x:Name="BtnConfigCategorias" 
                        Content="Categorías" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="#3B82F6"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigCategorias_Click"/>

                <!-- Tarifas -->
                <Button x:Name="BtnConfigTarifas" 
                        Content="Tarifas" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigTarifas_Click"/>

                <!-- Precios -->
                <Button x:Name="BtnConfigPrecios" 
                        Content="$ Precios" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigPrecios_Click"/>

                <!-- Usuarios -->
                <Button x:Name="BtnConfigUsuarios" 
                        Content="Usuarios" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigUsuarios_Click"/>

                <!-- Medios de Pago -->
                <Button x:Name="BtnConfigMediosPago" 
                        Content="$ Medios de Pago" 
                        Height="42"
                        Width="150"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigMediosPago_Click"/>

                <!-- Informes -->
                <Button x:Name="BtnConfigInformes" 
                        Content="Informes" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnConfigInformes_Click"/>

                <!-- Ajustes -->
                <Button x:Name="BtnConfigAjustes" 
                        Content="Ajustes" 
                        Height="42"
                        Width="120"
                        FontSize="13"
                        FontWeight="SemiBold"
                        Background="Transparent"
                        Foreground="#334155"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="BtnConfigAjustes_Click"/>
            </StackPanel>
        </Border>

        <!-- Barra de Filtros -->
        <Border Grid.Row="2" 
                x:Name="BarraFiltrosAbiertos"
                Background="White" 
                Padding="20,12"
                BorderBrush="#E5E7EB"
                BorderThickness="0,0,0,1"
                x:FieldModifier="public">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Menú hamburguesa -->
                <Button Grid.Column="0"
                        x:Name="BtnMenuHamburguesa"
                        Content="☰"
                        FontSize="18"
                        Width="40"
                        Height="38"
                        Background="Transparent"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        Margin="0,0,10,0"
                        Cursor="Hand"
                        Click="BtnMenuHamburguesa_Click"/>

                <!-- Dropdown Todos -->
                <ComboBox Grid.Column="1"
                          x:Name="CmbTodos"
                          Width="100"
                          Height="38"
                          Padding="10,8"
                          FontSize="12"
                          VerticalContentAlignment="Center"
                          BorderBrush="#D1D5DB"
                          BorderThickness="1"
                          Background="White"
                          SelectedIndex="0"
                          Margin="0,0,10,0"
                          SelectionChanged="CmbTodos_SelectionChanged"/>

                <!-- Filtrar por matrícula -->
                <Grid Grid.Column="2" Margin="0,0,10,0">
                    <TextBox x:Name="TxtFiltroMatricula" 
                             Width="200" 
                             Height="38"
                             Padding="12,8"
                             FontSize="12"
                             VerticalContentAlignment="Center"
                             BorderBrush="#D1D5DB"
                             BorderThickness="1"
                             Background="White"
                             TextChanged="TxtFiltroMatricula_TextChanged"
                             GotFocus="TxtFiltroMatricula_GotFocus"
                             LostFocus="TxtFiltroMatricula_LostFocus"/>
                    <TextBlock x:Name="PlaceholderMatricula"
                               Text="Filtrar por matrícula"
                               FontSize="12"
                               Foreground="#9CA3AF"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Margin="12,0,0,0"
                               IsHitTestVisible="False"/>
                </Grid>

                <!-- Dropdown Orden -->
                <ComboBox Grid.Column="3"
                          x:Name="CmbOrden"
                          Width="160"
                          Height="38"
                          Padding="10,8"
                          FontSize="12"
                          VerticalContentAlignment="Center"
                          BorderBrush="#D1D5DB"
                          BorderThickness="1"
                          Background="White"
                          SelectedIndex="0"
                          Margin="0,0,10,0"
                          SelectionChanged="CmbOrden_SelectionChanged">
                    <ComboBoxItem Content="Últimos ingresados"/>
                    <ComboBoxItem Content="Primeros ingresados"/>
                    <ComboBoxItem Content="Matrícula A-Z"/>
                    <ComboBoxItem Content="Matrícula Z-A"/>
                </ComboBox>

                <!-- Espacio -->
                <Grid Grid.Column="4"/>

                <!-- Icono descarga -->
                <Button Grid.Column="5"
                        x:Name="BtnDescargar"
                        Content="⬇"
                        FontSize="18"
                        Width="40"
                        Height="38"
                        Background="Transparent"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        Cursor="Hand"
                        Click="BtnDescargar_Click"/>
            </Grid>
        </Border>

        <!-- Contenido principal -->
        <Grid Grid.Row="3" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Panel de Configuración -->
            <Grid x:Name="PanelConfiguracion" Visibility="Collapsed" Grid.Row="0">
                <!-- Popup flotante para drag and drop -->
                <Popup x:Name="DragPreviewPopup"
                       IsOpen="False"
                       AllowsTransparency="True"
                       Placement="Absolute"
                       PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                       PopupAnimation="None"
                       StaysOpen="True">
                    <Border Background="White"
                            BorderBrush="#E5E7EB"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,10"
                            Opacity="0.95">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="☰"
                                       FontSize="18"
                                       Foreground="#9CA3AF"
                                       VerticalAlignment="Center"
                                       Margin="0,0,15,0"
                                       Cursor="SizeAll"/>
                            <TextBlock x:Name="DragPreviewText"
                                       Grid.Column="1"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="2"
                                       Orientation="Horizontal">
                                <Button Content="Modificar"
                                        Width="100"
                                        Height="35"
                                        FontSize="12"
                                        Background="Transparent"
                                        Foreground="#3B82F6"
                                        BorderBrush="#3B82F6"
                                        BorderThickness="1"
                                        Margin="0,0,10,0"
                                        IsEnabled="False"
                                        Opacity="0.5"/>
                                <Button Content="Eliminar"
                                        Width="100"
                                        Height="35"
                                        FontSize="12"
                                        Background="Transparent"
                                        Foreground="#EF4444"
                                        BorderBrush="#EF4444"
                                        BorderThickness="1"
                                        IsEnabled="False"
                                        Opacity="0.5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Popup>
                
                <!-- Panel Categorías -->
                <Grid x:Name="PanelConfigCategorias" 
                      Visibility="Visible"
                      Margin="40">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Título -->
                    <TextBlock Grid.Row="0"
                               Text="Categorías"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="#1F2937"
                               Margin="0,0,0,20"/>

                    <!-- Lista de categorías con drag and drop -->
                    <Border Grid.Row="1"
                            Background="White"
                            BorderBrush="#E5E7EB"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ItemsControl x:Name="ItemsCategoriasLista">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border x:Name="BorderCategoriaItem"
                                                Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="6"
                                                Margin="0,0,0,10"
                                                Padding="15"
                                                MouseLeftButtonDown="CategoriaItem_MouseLeftButtonDown"
                                                MouseMove="CategoriaItem_MouseMove"
                                                MouseLeftButtonUp="CategoriaItem_MouseLeftButtonUp"
                                                AllowDrop="True"
                                                Drop="CategoriaItem_Drop"
                                                DragOver="CategoriaItem_DragOver"
                                                DragLeave="CategoriaItem_DragLeave"
                                                GiveFeedback="CategoriaItem_GiveFeedback"
                                                QueryContinueDrag="CategoriaItem_QueryContinueDrag">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Icono de arrastre -->
                                                <TextBlock Grid.Column="0"
                                                           Text="☰"
                                                           FontSize="18"
                                                           Foreground="#9CA3AF"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,15,0"
                                                           Cursor="SizeAll"
                                                           MouseLeftButtonDown="CategoriaItem_MouseLeftButtonDown"
                                                           MouseMove="CategoriaItem_MouseMove"
                                                           MouseLeftButtonUp="CategoriaItem_MouseLeftButtonUp"/>

                                                <!-- Nombre de la categoría -->
                                                <TextBlock Grid.Column="1"
                                                           Text="{Binding Nombre}"
                                                           FontSize="16"
                                                           FontWeight="SemiBold"
                                                           Foreground="#1F2937"
                                                           VerticalAlignment="Center"/>

                                                <!-- Botones de acción -->
                                                <StackPanel Grid.Column="2"
                                                           Orientation="Horizontal">
                                                    <Button Content="Modificar"
                                                            Width="100"
                                                            Height="35"
                                                            FontSize="12"
                                                            Background="Transparent"
                                                            Foreground="#3B82F6"
                                                            BorderBrush="#3B82F6"
                                                            BorderThickness="1"
                                                            Margin="0,0,10,0"
                                                            Cursor="Hand"
                                                            Click="BtnModificarCategoria_Click"
                                                            Tag="{Binding}"/>
                                                    <Button Content="Eliminar"
                                                            Width="100"
                                                            Height="35"
                                                            FontSize="12"
                                                            Background="Transparent"
                                                            Foreground="#EF4444"
                                                            BorderBrush="#EF4444"
                                                            BorderThickness="1"
                                                            Cursor="Hand"
                                                            Click="BtnEliminarCategoria_Click"
                                                            Tag="{Binding}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Border>

                    <!-- Instrucción y botón Nueva Categoría -->
                    <Grid Grid.Row="2" Margin="0,20,0,0">
                        <StackPanel Orientation="Horizontal"
                                   HorizontalAlignment="Left">
                            <TextBlock Text="* Arrastra y suelta los elementos para "
                                       FontSize="12"
                                       Foreground="#64748B"
                                       VerticalAlignment="Center"
                                       Margin="0,0,5,0"/>
                            <TextBlock Text="ordenarlos"
                                       FontSize="12"
                                       FontWeight="Bold"
                                       Foreground="#64748B"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <Button x:Name="BtnNuevaCategoria"
                                Content="Nueva Categoría"
                                Width="150"
                                Height="40"
                                FontSize="13"
                                FontWeight="SemiBold"
                                Background="Transparent"
                                Foreground="#3B82F6"
                                BorderBrush="#3B82F6"
                                BorderThickness="1"
                                HorizontalAlignment="Right"
                                Cursor="Hand"
                                Click="BtnNuevaCategoria_Click"/>
                    </Grid>
                </Grid>

                <!-- Panel Precios -->
                <Grid x:Name="PanelConfigPrecios" 
                      Visibility="Collapsed"
                      Margin="40">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Título -->
                    <TextBlock Grid.Row="0"
                               Text="Precios"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="#1F2937"
                               Margin="0,0,0,10"/>

                    <!-- Descripción -->
                    <TextBlock Grid.Row="1"
                               Text="Establece los precios para cada categoría de vehículo en cada tipo de tarifa"
                               FontSize="14"
                               Foreground="#64748B"
                               Margin="0,0,0,30"/>

                    <!-- Tabla de precios -->
                    <ScrollViewer Grid.Row="2"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Auto">
                        <Border Background="White"
                                BorderBrush="#E5E7EB"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="20">
                            <Grid x:Name="GridPrecios">
                                <!-- La tabla se generará dinámicamente en el código -->
                            </Grid>
                        </Border>
                    </ScrollViewer>

                    <!-- Instrucciones -->
                    <StackPanel Grid.Row="3"
                               Margin="0,20,0,0">
                        <TextBlock Text="Click en la celda para editar el valor"
                                   FontSize="12"
                                   Foreground="#64748B"
                                   Margin="0,0,0,5"/>
                        <TextBlock Text="El cambio de precios, no afectará a los tickets abiertos con anterioridad."
                                   FontSize="12"
                                   Foreground="#64748B"/>
                    </StackPanel>
                </Grid>

                <!-- Panel Usuarios -->
                <Grid x:Name="PanelConfigUsuarios" 
                      Visibility="Collapsed"
                      Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Título -->
                    <TextBlock Grid.Row="0"
                               Text="Usuarios"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="#1F2937"
                               Margin="0,0,0,20"/>

                    <!-- Tabla de usuarios con ScrollViewer horizontal -->
                    <ScrollViewer Grid.Row="1"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Auto">
                        <Border Background="White"
                                BorderBrush="#E5E7EB"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="0"
                                HorizontalAlignment="Stretch">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Headers -->
                                <Border Grid.Row="0"
                                        Background="#F9FAFB"
                                        BorderBrush="#E5E7EB"
                                        BorderThickness="0,0,0,1">
                                    <Grid HorizontalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="180"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0"
                                                   Text="#"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1"
                                                   Text="Nombre"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="2"
                                                   Text="Apellido"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="3"
                                                   Text="Usuario"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="4"
                                                   Text="Rol"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="5"
                                                   Text="Último Acceso"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="6"
                                                   Text="Acciones"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Foreground="#374151"
                                                   Padding="10,12"
                                                   VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <!-- Lista de usuarios -->
                                <ItemsControl Grid.Row="1"
                                              x:Name="ItemsUsuarios"
                                              HorizontalAlignment="Stretch">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="White"
                                                    BorderBrush="#E5E7EB"
                                                    BorderThickness="0,0,0,1"
                                                    Padding="0"
                                                    HorizontalAlignment="Stretch">
                                                <Grid HorizontalAlignment="Stretch">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="60"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="180"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0"
                                                               Text="{Binding Numero}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="1"
                                                               Text="{Binding Nombre}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="2"
                                                               Text="{Binding Apellido}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="3"
                                                               Text="{Binding Username}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="4"
                                                               Text="{Binding RolDisplay}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="5"
                                                               Text="{Binding UltimoAccesoDisplay}"
                                                               FontSize="14"
                                                               Foreground="#1F2937"
                                                               Padding="10,12"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <StackPanel Grid.Column="6"
                                                               Orientation="Horizontal"
                                                               Margin="5,8"
                                                               HorizontalAlignment="Left">
                                                        <Button Content="Editar"
                                                                MinWidth="65"
                                                                Height="32"
                                                                FontSize="11"
                                                                Background="Transparent"
                                                                Foreground="#3B82F6"
                                                                BorderBrush="#3B82F6"
                                                                BorderThickness="1"
                                                                Margin="0,0,5,0"
                                                                Padding="8,0"
                                                                Cursor="Hand"
                                                                Click="BtnEditarUsuario_Click"
                                                                Tag="{Binding}"/>
                                                        <Button Content="Eliminar"
                                                                MinWidth="65"
                                                                Height="32"
                                                                FontSize="11"
                                                                Background="Transparent"
                                                                Foreground="#EF4444"
                                                                BorderBrush="#EF4444"
                                                                BorderThickness="1"
                                                                Padding="8,0"
                                                                Cursor="Hand"
                                                                Click="BtnEliminarUsuario_Click"
                                                                Tag="{Binding}"
                                                                IsEnabled="{Binding PuedeEliminar}"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </Border>
                    </ScrollViewer>

                    <!-- Botón Crear Usuario -->
                    <Button Grid.Row="2"
                            x:Name="BtnCrearUsuario"
                            Content="Crear usuario"
                            Width="150"
                            Height="40"
                            FontSize="13"
                            FontWeight="SemiBold"
                            Background="Transparent"
                            Foreground="#3B82F6"
                            BorderBrush="#3B82F6"
                            BorderThickness="1"
                            HorizontalAlignment="Right"
                            Margin="0,20,0,0"
                            Cursor="Hand"
                            Click="BtnCrearUsuario_Click"/>
                </Grid>

                <!-- Popup para crear/editar usuario -->
                <Border x:Name="PopupUsuario"
                        Visibility="Collapsed"
                        Background="#80000000"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        MouseLeftButtonDown="PopupUsuario_MouseLeftButtonDown">
                    <Border Background="White"
                            CornerRadius="8"
                            Padding="30"
                            MinWidth="450"
                            MaxWidth="500"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            BorderBrush="#E5E7EB"
                            BorderThickness="1"
                            MouseLeftButtonDown="PopupUsuarioContent_MouseLeftButtonDown">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Título -->
                            <TextBlock Grid.Row="0"
                                       x:Name="TxtTituloPopupUsuario"
                                       Text="Nuevo Usuario"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,20"/>

                            <!-- Campo Nombre -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,15">
                                <TextBlock Text="Nombre"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <TextBox x:Name="TxtNombreUsuarioPopup"
                                         Height="40"
                                         Padding="10,8"
                                         VerticalContentAlignment="Center"
                                         FontSize="14"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"
                                         Background="White"/>
                            </StackPanel>

                            <!-- Campo Apellido -->
                            <StackPanel Grid.Row="2" Margin="0,0,0,15">
                                <TextBlock Text="Apellido"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <TextBox x:Name="TxtApellidoUsuarioPopup"
                                         Height="40"
                                         Padding="10,8"
                                         VerticalContentAlignment="Center"
                                         FontSize="14"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"
                                         Background="White"/>
                            </StackPanel>

                            <!-- Campo Username -->
                            <StackPanel Grid.Row="3" Margin="0,0,0,15">
                                <TextBlock Text="Usuario"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <TextBox x:Name="TxtUsernameUsuarioPopup"
                                         Height="40"
                                         Padding="10,8"
                                         VerticalContentAlignment="Center"
                                         FontSize="14"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"
                                         Background="White"/>
                            </StackPanel>

                            <!-- Campo Contraseña -->
                            <StackPanel Grid.Row="4" Margin="0,0,0,15">
                                <TextBlock Text="Contraseña"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <Border BorderBrush="#D1D5DB"
                                        BorderThickness="1"
                                        Height="40"
                                        Background="White">
                                    <PasswordBox x:Name="TxtPasswordUsuarioPopup"
                                                 BorderThickness="0"
                                                 VerticalContentAlignment="Center"
                                                 FontSize="14"
                                                 Margin="10,0"/>
                                </Border>
                            </StackPanel>

                            <!-- Campo Repetir Contraseña -->
                            <StackPanel Grid.Row="5" Margin="0,0,0,15">
                                <TextBlock Text="Repetir Contraseña"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <Border BorderBrush="#D1D5DB"
                                        BorderThickness="1"
                                        Height="40"
                                        Background="White">
                                    <PasswordBox x:Name="TxtPasswordRepetirUsuarioPopup"
                                                 BorderThickness="0"
                                                 VerticalContentAlignment="Center"
                                                 FontSize="14"
                                                 Margin="10,0"/>
                                </Border>
                            </StackPanel>

                            <!-- Campo Email -->
                            <StackPanel Grid.Row="6" Margin="0,0,0,15">
                                <TextBlock Text="Email"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <TextBox x:Name="TxtEmailUsuarioPopup"
                                         Height="40"
                                         Padding="10,8"
                                         VerticalContentAlignment="Center"
                                         FontSize="14"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"
                                         Background="White"/>
                            </StackPanel>

                            <!-- Campo Rol -->
                            <StackPanel Grid.Row="7" Margin="0,0,0,20">
                                <TextBlock Text="Rol"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <ComboBox x:Name="CmbRolUsuarioPopup"
                                          Height="40"
                                          Padding="10,8"
                                          VerticalContentAlignment="Center"
                                          FontSize="14"
                                          BorderBrush="#D1D5DB"
                                          BorderThickness="1"
                                          Background="White">
                                    <ComboBoxItem Content="admin" Tag="admin"/>
                                    <ComboBoxItem Content="operador" Tag="operador"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Botones -->
                            <StackPanel Grid.Row="8"
                                       Orientation="Horizontal"
                                       HorizontalAlignment="Right">
                                <Button Content="Cancelar"
                                        Width="100"
                                        Height="40"
                                        FontSize="13"
                                        FontWeight="SemiBold"
                                        Background="Transparent"
                                        Foreground="#6B7280"
                                        BorderBrush="#D1D5DB"
                                        BorderThickness="1"
                                        Margin="0,0,10,0"
                                        Cursor="Hand"
                                        Click="BtnCancelarUsuario_Click"/>
                                <Button Content="Guardar"
                                        Width="100"
                                        Height="40"
                                        FontSize="13"
                                        FontWeight="SemiBold"
                                        Background="#3B82F6"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Click="BtnGuardarUsuario_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Border>

                <!-- Popup para crear/editar categoría -->
                <Border x:Name="PopupCategoria"
                        Visibility="Collapsed"
                        Background="#80000000"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        MouseLeftButtonDown="PopupCategoria_MouseLeftButtonDown">
                    <Border Background="White"
                            CornerRadius="8"
                            Padding="30"
                            MinWidth="400"
                            MaxWidth="500"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            BorderBrush="#E5E7EB"
                            BorderThickness="1"
                            MouseLeftButtonDown="PopupCategoriaContent_MouseLeftButtonDown">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Título -->
                            <TextBlock Grid.Row="0"
                                       x:Name="TxtTituloPopupCategoria"
                                       Text="Nueva Categoría"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,20"/>

                            <!-- Campo Nombre -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,20">
                                <TextBlock Text="Nombre de la categoría"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#374151"
                                           Margin="0,0,0,5"/>
                                <TextBox x:Name="TxtNombreCategoria"
                                         Height="40"
                                         Padding="10,8"
                                         VerticalContentAlignment="Center"
                                         FontSize="14"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"
                                         Background="White"/>
                            </StackPanel>

                            <!-- Botones -->
                            <StackPanel Grid.Row="2"
                                       Orientation="Horizontal"
                                       HorizontalAlignment="Right">
                                <Button x:Name="BtnCancelarCategoria"
                                        Content="Cancelar"
                                        Width="100"
                                        Height="40"
                                        FontSize="13"
                                        Background="Transparent"
                                        Foreground="#64748B"
                                        BorderBrush="#D1D5DB"
                                        BorderThickness="1"
                                        Margin="0,0,10,0"
                                        Cursor="Hand"
                                        Click="BtnCancelarCategoria_Click"/>
                                <Button x:Name="BtnGuardarCategoria"
                                        Content="Guardar"
                                        Width="100"
                                        Height="40"
                                        FontSize="13"
                                        FontWeight="SemiBold"
                                        Background="#3B82F6"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Click="BtnGuardarCategoria_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Border>

                <!-- Otros paneles de configuración (inicialmente ocultos) -->
                <Grid x:Name="PanelConfigTarifas" Visibility="Collapsed">
                    <TextBlock Text="Tarifas" 
                               FontSize="24" 
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </Grid>

                <!-- Panel Precios (ya definido arriba, este es un placeholder que se elimina) -->

                <!-- Panel Usuarios (ya definido arriba, este es un placeholder que se elimina) -->

                <Grid x:Name="PanelConfigMediosPago" Visibility="Collapsed">
                    <TextBlock Text="Medios de Pago" 
                               FontSize="24" 
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </Grid>

                <Grid x:Name="PanelConfigInformes" Visibility="Collapsed">
                    <TextBlock Text="Informes" 
                               FontSize="24" 
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </Grid>

                <Grid x:Name="PanelConfigAjustes" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Título -->
                    <TextBlock Grid.Row="0"
                               Text="Ajustes" 
                               FontSize="24" 
                               FontWeight="Bold"
                               Margin="20,20,20,10"/>

                    <!-- Tabs -->
                    <Grid Grid.Row="1" Margin="20,0,20,20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Barra de tabs -->
                        <StackPanel Grid.Row="0" 
                                    Orientation="Horizontal"
                                    Margin="0,0,0,20">
                            <Button x:Name="BtnTabPerfil"
                                    Content="Perfil"
                                    Height="40"
                                    MinWidth="120"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="#3B82F6"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Margin="0,0,5,0"
                                    Cursor="Hand"
                                    Click="BtnTabPerfil_Click"/>
                            <Button x:Name="BtnTabTickets"
                                    Content="Tickets"
                                    Height="40"
                                    MinWidth="120"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#64748B"
                                    BorderThickness="0"
                                    Margin="0,0,5,0"
                                    Cursor="Hand"
                                    Click="BtnTabTickets_Click"/>
                            <Button x:Name="BtnTabPermisos"
                                    Content="Permisos Operadores"
                                    Height="40"
                                    MinWidth="150"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#64748B"
                                    BorderThickness="0"
                                    Margin="0,0,5,0"
                                    Cursor="Hand"
                                    Click="BtnTabPermisos_Click"/>
                            <Button x:Name="BtnTabMonitor"
                                    Content="Pantalla Cliente"
                                    Height="40"
                                    MinWidth="120"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#64748B"
                                    BorderThickness="0"
                                    Margin="0,0,5,0"
                                    Cursor="Hand"
                                    Click="BtnTabMonitor_Click"/>
                            <Button x:Name="BtnTabModulos"
                                    Content="Módulos"
                                    Height="40"
                                    MinWidth="120"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#64748B"
                                    BorderThickness="0"
                                    Margin="0,0,5,0"
                                    Cursor="Hand"
                                    Click="BtnTabModulos_Click"/>
                            <Button x:Name="BtnTabBaseDatos"
                                    Content="Base de Datos"
                                    Height="40"
                                    MinWidth="130"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#64748B"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnTabBaseDatos_Click"/>
                        </StackPanel>

                        <!-- Contenido de tabs -->
                        <Grid Grid.Row="1">
                            <!-- Tab Perfil -->
                            <Grid x:Name="PanelTabPerfil" Visibility="Visible">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="0,0,0,20">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Descripción -->
                                        <TextBlock Grid.Row="0"
                                                   Text="Establece las opciones generales de tu perfil"
                                                   FontSize="14"
                                                   Foreground="#64748B"
                                                   Margin="0,0,0,20"/>

                                        <!-- Contenido principal -->
                                        <Grid Grid.Row="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Panel izquierdo - Empresa -->
                                            <Border Grid.Column="0"
                                                    Background="White"
                                                    BorderBrush="#E5E7EB"
                                                    BorderThickness="1"
                                                    CornerRadius="6"
                                                    Padding="20">
                                                <StackPanel>
                                                    <TextBlock Text="Empresa"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,20"/>

                                                    <!-- Nombre -->
                                                    <TextBlock Text="Nombre"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <TextBox x:Name="TxtAjustesNombre"
                                                             Height="40"
                                                             Padding="10,8"
                                                             VerticalContentAlignment="Center"
                                                             FontSize="14"
                                                             BorderBrush="#D1D5DB"
                                                             BorderThickness="1"
                                                             Background="White"
                                                             Margin="0,0,0,15"/>

                                                    <!-- Dirección -->
                                                    <TextBlock Text="Dirección"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <TextBox x:Name="TxtAjustesDireccion"
                                                             Height="40"
                                                             Padding="10,8"
                                                             VerticalContentAlignment="Center"
                                                             FontSize="14"
                                                             BorderBrush="#D1D5DB"
                                                             BorderThickness="1"
                                                             Background="White"
                                                             Margin="0,0,0,15"/>

                                                    <!-- Ciudad -->
                                                    <TextBlock Text="Ciudad"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <TextBox x:Name="TxtAjustesCiudad"
                                                             Height="40"
                                                             Padding="10,8"
                                                             VerticalContentAlignment="Center"
                                                             FontSize="14"
                                                             BorderBrush="#D1D5DB"
                                                             BorderThickness="1"
                                                             Background="White"
                                                             Margin="0,0,0,15"/>

                                                    <!-- País -->
                                                    <TextBlock Text="País"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <ComboBox x:Name="CmbAjustesPais"
                                                              Height="40"
                                                              Padding="10,8"
                                                              VerticalContentAlignment="Center"
                                                              FontSize="14"
                                                              BorderBrush="#D1D5DB"
                                                              BorderThickness="1"
                                                              Background="White"
                                                              Margin="0,0,0,15">
                                                        <ComboBoxItem Content="Argentina" Tag="Argentina"/>
                                                        <ComboBoxItem Content="Uruguay" Tag="Uruguay"/>
                                                        <ComboBoxItem Content="Chile" Tag="Chile"/>
                                                        <ComboBoxItem Content="Paraguay" Tag="Paraguay"/>
                                                        <ComboBoxItem Content="Brasil" Tag="Brasil"/>
                                                    </ComboBox>

                                                    <!-- Teléfono -->
                                                    <TextBlock Text="Teléfono"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <TextBox x:Name="TxtAjustesTelefono"
                                                             Height="40"
                                                             Padding="10,8"
                                                             VerticalContentAlignment="Center"
                                                             FontSize="14"
                                                             BorderBrush="#D1D5DB"
                                                             BorderThickness="1"
                                                             Background="White"
                                                             Margin="0,0,0,15"/>

                                                    <!-- Slogan -->
                                                    <TextBlock Text="Slogan"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <TextBox x:Name="TxtAjustesSlogan"
                                                             Height="40"
                                                             Padding="10,8"
                                                             VerticalContentAlignment="Center"
                                                             FontSize="14"
                                                             BorderBrush="#D1D5DB"
                                                             BorderThickness="1"
                                                             Background="White"/>
                                                </StackPanel>
                                            </Border>

                                            <!-- Panel derecho - Configuración -->
                                            <Border Grid.Column="2"
                                                    Background="White"
                                                    BorderBrush="#E5E7EB"
                                                    BorderThickness="1"
                                                    CornerRadius="6"
                                                    Padding="20">
                                                <StackPanel>
                                                    <!-- Impresoras -->
                                                    <TextBlock Text="Impresoras"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Imprimir en"
                                                               FontSize="13"
                                                               FontWeight="SemiBold"
                                                               Foreground="#374151"
                                                               Margin="0,0,0,5"/>
                                                    <ComboBox x:Name="CmbAjustesImpresora"
                                                              Height="40"
                                                              Padding="10,8"
                                                              VerticalContentAlignment="Center"
                                                              FontSize="14"
                                                              BorderBrush="#D1D5DB"
                                                              BorderThickness="1"
                                                              Background="White"
                                                              Margin="0,0,0,30"/>

                                                </StackPanel>
                                            </Border>
                                        </Grid>

                                        <!-- Botón Guardar -->
                                        <Button x:Name="BtnAjustesGuardar"
                                                Content="Guardar"
                                                Width="120"
                                                Height="45"
                                                FontSize="14"
                                                FontWeight="SemiBold"
                                                Background="#3B82F6"
                                                Foreground="White"
                                                BorderThickness="0"
                                                HorizontalAlignment="Right"
                                                Margin="0,20,0,0"
                                                Cursor="Hand"
                                                Click="BtnAjustesGuardar_Click"/>
                                    </Grid>
                                </ScrollViewer>
                            </Grid>

                            <!-- Tab Tickets -->
                            <Grid x:Name="PanelTabTickets" Visibility="Collapsed">
                                <TextBlock Text="En desarrollo"
                                           FontSize="18"
                                           Foreground="#9CA3AF"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Tab Permisos Operadores -->
                            <Grid x:Name="PanelTabPermisos" Visibility="Collapsed">
                                <TextBlock Text="En desarrollo"
                                           FontSize="18"
                                           Foreground="#9CA3AF"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Tab Monitor -->
                            <Grid x:Name="PanelTabMonitor" Visibility="Collapsed">
                                <TextBlock Text="En desarrollo"
                                           FontSize="18"
                                           Foreground="#9CA3AF"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Tab Módulos -->
                            <Grid x:Name="PanelTabModulos" Visibility="Collapsed">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel Margin="20">
                                        <!-- Módulo ANPR -->
                                        <Border Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="20"
                                                Margin="0,0,0,20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="ANPR (Cámaras con Reconocimiento de Matrículas)"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Utilice Cámaras ANPR con o sin Barreras Vehiculares para automatizar el ingreso y egreso de vehículos."
                                                               FontSize="14"
                                                               Foreground="#6B7280"
                                                               TextWrapping="Wrap"
                                                               Margin="0,0,0,15"/>
                                                    <CheckBox x:Name="ChkModuloANPR"
                                                             Content="Usar módulo ANPR"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Foreground="#1F2937"
                                                             Margin="0,0,0,8"
                                                             Checked="ChkModulo_Checked"
                                                             Unchecked="ChkModulo_Unchecked"/>
                                                    <TextBlock Text="Al activarlo encontrarás una nueva pestaña en &quot;Configuración&quot;"
                                                               FontSize="12"
                                                               Foreground="#9CA3AF"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1"
                                                           Text="🎓"
                                                           FontSize="24"
                                                           VerticalAlignment="Top"
                                                           Margin="10,0,0,0"/>
                                            </Grid>
                                        </Border>

                                        <!-- Módulo TERMINAL -->
                                        <Border Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="20"
                                                Margin="0,0,0,20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Terminal"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Utilice un teléfono móvil, tablet o PC como terminal de ingreso. De esta forma podrá darle ingreso a los vehículos en uno o varios dispositivos adicionales. Podrá usarlo a distancia y no requiere internet."
                                                               FontSize="14"
                                                               Foreground="#6B7280"
                                                               TextWrapping="Wrap"
                                                               Margin="0,0,0,15"/>
                                                    <CheckBox x:Name="ChkModuloTERMINAL"
                                                             Content="Usar módulo Terminal"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Foreground="#1F2937"
                                                             Margin="0,0,0,8"
                                                             Checked="ChkModulo_Checked"
                                                             Unchecked="ChkModulo_Unchecked"/>
                                                    <TextBlock Text="Al activarlo encontrarás una nueva pestaña en &quot;Configuración&quot;"
                                                               FontSize="12"
                                                               Foreground="#9CA3AF"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1"
                                                           Text="🎓"
                                                           FontSize="24"
                                                           VerticalAlignment="Top"
                                                           Margin="10,0,0,0"/>
                                            </Grid>
                                        </Border>

                                        <!-- Módulo EMAIL -->
                                        <Border Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="20"
                                                Margin="0,0,0,20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Email"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Configure el envío de correos electrónicos para notificaciones, reportes y comunicaciones automáticas con los clientes."
                                                               FontSize="14"
                                                               Foreground="#6B7280"
                                                               TextWrapping="Wrap"
                                                               Margin="0,0,0,15"/>
                                                    <CheckBox x:Name="ChkModuloEMAIL"
                                                             Content="Usar módulo Email"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Foreground="#1F2937"
                                                             Margin="0,0,0,8"
                                                             Checked="ChkModulo_Checked"
                                                             Unchecked="ChkModulo_Unchecked"/>
                                                    <TextBlock Text="Al activarlo encontrarás una nueva pestaña en &quot;Configuración&quot;"
                                                               FontSize="12"
                                                               Foreground="#9CA3AF"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1"
                                                           Text="🎓"
                                                           FontSize="24"
                                                           VerticalAlignment="Top"
                                                           Margin="10,0,0,0"/>
                                            </Grid>
                                        </Border>

                                        <!-- Módulo Pantalla Cliente -->
                                        <Border Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="20"
                                                Margin="0,0,0,20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Pantalla Cliente"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Muestra una pantalla exclusiva para el cliente con información de bienvenida, pago y agradecimiento en tiempo real."
                                                               FontSize="14"
                                                               Foreground="#6B7280"
                                                               TextWrapping="Wrap"
                                                               Margin="0,0,0,15"/>
                                                    <CheckBox x:Name="ChkModuloMONITOR"
                                                             Content="Usar módulo Pantalla Cliente"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Foreground="#1F2937"
                                                             Margin="0,0,0,8"
                                                             Checked="ChkModulo_Checked"
                                                             Unchecked="ChkModulo_Unchecked"/>
                                                    <TextBlock Text="Al activarlo encontrarás una nueva pestaña en &quot;Configuración&quot;"
                                                               FontSize="12"
                                                               Foreground="#9CA3AF"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1"
                                                           Text="🎓"
                                                           FontSize="24"
                                                           VerticalAlignment="Top"
                                                           Margin="10,0,0,0"/>
                                            </Grid>
                                        </Border>

                                        <!-- Módulo QR MercadoPago -->
                                        <Border Background="White"
                                                BorderBrush="#E5E7EB"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="20"
                                                Margin="0,0,0,20">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="QR MercadoPago"
                                                               FontSize="16"
                                                               FontWeight="Bold"
                                                               Foreground="#1F2937"
                                                               Margin="0,0,0,10"/>
                                                    <TextBlock Text="Integración con Mercado Pago para mostrar códigos QR de pago en la pantalla del cliente."
                                                               FontSize="14"
                                                               Foreground="#6B7280"
                                                               TextWrapping="Wrap"
                                                               Margin="0,0,0,15"/>
                                                    <CheckBox x:Name="ChkModuloMERCADOPAGO"
                                                             Content="Usar módulo QR MercadoPago"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Foreground="#1F2937"
                                                             Margin="0,0,0,8"
                                                             Checked="ChkModulo_Checked"
                                                             Unchecked="ChkModulo_Unchecked"/>
                                                    <TextBlock Text="Al activarlo encontrarás una nueva pestaña en &quot;Configuración&quot;"
                                                               FontSize="12"
                                                               Foreground="#9CA3AF"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1"
                                                           Text="💳"
                                                           FontSize="24"
                                                           VerticalAlignment="Top"
                                                           Margin="10,0,0,0"/>
                                            </Grid>
                                        </Border>

                                    </StackPanel>
                                </ScrollViewer>
                            </Grid>

                            <!-- Tab Base de Datos -->
                            <Grid x:Name="PanelTabBaseDatos" Visibility="Collapsed">
                                <TextBlock Text="En desarrollo"
                                           FontSize="18"
                                           Foreground="#9CA3AF"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
            
            <!-- Panel de Mensuales -->
            <Grid x:Name="PanelMensuales" Visibility="Collapsed" Grid.Row="0" Margin="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Tabs y filtros -->
                <StackPanel Grid.Row="0" Margin="0,0,0,10">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button x:Name="BtnMensualesClientesTab"
                                Content="Clientes Activos (0)"
                                Width="170"
                                Height="36"
                                FontSize="13"
                                FontWeight="SemiBold"
                                Background="#3B82F6"
                                Foreground="White"
                                BorderThickness="0"
                                Margin="0,0,10,0"
                                Cursor="Hand"
                                Click="BtnMensualesClientesTab_Click"/>
                        <Button x:Name="BtnMensualesVehiculosTab"
                                Content="Vehículos (0)"
                                Width="150"
                                Height="36"
                                FontSize="13"
                                FontWeight="SemiBold"
                                Background="Transparent"
                                Foreground="#334155"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="BtnMensualesVehiculosTab_Click"/>
                    </StackPanel>

                    <StackPanel x:Name="StackPanelMensualesFiltros" Orientation="Horizontal" Margin="0,0,0,6">
                        <ComboBox x:Name="CmbMensualesEstado"
                                  Width="140"
                                  Height="32"
                                  SelectedIndex="0"
                                  SelectionChanged="FiltroMensuales_SelectionChanged">
                            <ComboBoxItem Content="Activos"/>
                            <ComboBoxItem Content="Archivados"/>
                            <ComboBoxItem Content="Todos"/>
                        </ComboBox>
                        <StackPanel Margin="10,0,0,0" VerticalAlignment="Center">
                            <TextBlock Text="Matrícula"
                                       FontSize="11"
                                       Foreground="#6B7280"
                                       Margin="0,0,0,2"/>
                            <TextBox x:Name="TxtMensualesMatricula"
                                     Width="160"
                                     Height="32"
                                     TextChanged="FiltroMensuales_TextChanged"/>
                        </StackPanel>
                        <StackPanel Margin="10,0,0,0" VerticalAlignment="Center">
                            <TextBlock Text="Cliente"
                                       FontSize="11"
                                       Foreground="#6B7280"
                                       Margin="0,0,0,2"/>
                            <TextBox x:Name="TxtMensualesCliente"
                                     Width="200"
                                     Height="32"
                                     TextChanged="FiltroMensuales_TextChanged"/>
                        </StackPanel>
                        <CheckBox x:Name="ChkMensualesConDeuda"
                                  Content="Con deuda"
                                  Margin="10,0,0,0"
                                  VerticalAlignment="Center"
                                  Checked="FiltroMensuales_Checked"
                                  Unchecked="FiltroMensuales_Checked"/>
                        <Button x:Name="BtnMensualesAgregarCliente"
                                Content="Agregar Cliente"
                                Margin="14,0,0,0"
                                Padding="14,6"
                                Background="#1E3A8A"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="BtnMensualesAgregarCliente_Click"/>
                    </StackPanel>
                </StackPanel>

                <!-- Contenido -->
                <Grid Grid.Row="1">
                    <Grid x:Name="GridMensualesClientes" Visibility="Visible">
                        <DataGrid x:Name="DataGridMensualesClientes"
                              AutoGenerateColumns="False"
                              HeadersVisibility="Column"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              RowBackground="White"
                              AlternatingRowBackground="#F9FAFB"
                              BorderThickness="0"
                              GridLinesVisibility="Horizontal"
                              ColumnHeaderHeight="32"
                              RowHeight="34"
                              SelectionChanged="DataGridMensualesClientes_SelectionChanged">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                <DataGridTextColumn Header="Cliente" Binding="{Binding NombreCompleto}" Width="200"/>
                                <DataGridTextColumn Header="Vehículos" Binding="{Binding CantVehiculos}" Width="90"/>
                                <DataGridTextColumn Header="Matrículas" Binding="{Binding MatriculasConcat}" Width="200"/>
                                <DataGridTextColumn Header="Balance" Binding="{Binding Balance, StringFormat={}{0:$#,0.00}}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>

                    <Grid x:Name="GridMensualesVehiculos" Visibility="Collapsed">
                        <DataGrid x:Name="DataGridMensualesVehiculos"
                              AutoGenerateColumns="False"
                              HeadersVisibility="Column"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              MouseDoubleClick="DataGridMensualesVehiculos_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Matrícula" Binding="{Binding Matricula}" Width="120"/>
                            <DataGridTextColumn Header="Cliente" Binding="{Binding ClienteNombre}" Width="200"/>
                            <DataGridTextColumn Header="Categoría" Binding="{Binding CategoriaNombre}" Width="120"/>
                            <DataGridTextColumn Header="Tarifa" Binding="{Binding TarifaNombre}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    </Grid>

                    <Grid x:Name="GridMensualesDetalle" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,15">
                            <TextBlock Text="Clientes Mensuales"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="#6B7280"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,5"/>
                            <TextBlock x:Name="TxtMensualNombreDetalle"
                                       Text="Cliente"
                                       FontSize="22"
                                       FontWeight="Bold"
                                       FontStyle="Italic"
                                       Foreground="#6B7280"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,10"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                <Button Content="&lt; Volver"
                                        Padding="8,4"
                                        Background="Transparent"
                                        Foreground="#1E3A8A"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Click="BtnMensualesVolver_Click"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Tabs -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                            <Button x:Name="BtnMensualDetalleTabCuenta"
                                    Content="Cuenta Corriente"
                                    Padding="12,6"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    Background="#3B82F6"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Margin="0,0,8,0"
                                    Cursor="Hand"
                                    Click="BtnMensualDetalleTabCuenta_Click"/>
                            <Button x:Name="BtnMensualDetalleTabVehiculos"
                                    Content="Vehículos (0)"
                                    Padding="12,6"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    Background="Transparent"
                                    Foreground="#334155"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnMensualDetalleTabVehiculos_Click"/>
                        </StackPanel>

                        <!-- Contenido principal: dos columnas -->
                        <Grid Grid.Row="2" x:Name="GridMensualDetalleContenido">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition x:Name="ColumnaDetalleCliente" Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Columna izquierda: Detalles del cliente -->
                            <ScrollViewer x:Name="ScrollViewerDetalleCliente" Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,15,0">
                                <StackPanel>
                                    <!-- Detalles del Cliente -->
                                    <TextBlock Text="Detalles del Cliente"
                                               FontSize="14"
                                               FontWeight="Bold"
                                               Foreground="#1F2937"
                                               Margin="0,0,0,12"/>
                                    
                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Nombre:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteNombre" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                        
                                        <TextBlock Text="WhatsApp:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteWhatsapp" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                        
                                        <TextBlock Text="Email:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteEmail" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                        
                                        <TextBlock Text="DNI:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteDNI" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                        
                                        <TextBlock Text="CUIT:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteCUIT" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                        
                                        <TextBlock Text="Dirección:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                        <TextBlock x:Name="TxtDetalleClienteDireccion" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                    </StackPanel>

                                    <!-- Nota -->
                                    <TextBlock Text="Nota"
                                               FontSize="14"
                                               FontWeight="Bold"
                                               Foreground="#1F2937"
                                               Margin="0,0,0,8"/>
                                    <TextBox x:Name="TxtDetalleClienteNota"
                                             Height="80"
                                             TextWrapping="Wrap"
                                             AcceptsReturn="True"
                                             VerticalScrollBarVisibility="Auto"
                                             BorderBrush="#D1D5DB"
                                             BorderThickness="1"
                                             Padding="8"
                                             Margin="0,0,0,15"/>

                                    <!-- Botones de acción -->
                                    <StackPanel>
                                        <Button Content="Agregar Vehículo"
                                                Padding="12,8"
                                                Margin="0,0,0,8"
                                                Background="#10B981"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnAgregarVehiculoDesdeDetalle_Click"/>
                                        <Button Content="Editar"
                                                Padding="12,8"
                                                Margin="0,0,0,8"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnDetalleClienteEditar_Click"/>
                                        <Button Content="Archivar"
                                                Padding="12,8"
                                                Margin="0,0,0,8"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnDetalleClienteArchivar_Click"/>
                                        <Button Content="Eliminar Cuenta"
                                                Padding="12,8"
                                                Margin="0,0,0,8"
                                                Background="#DC2626"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnDetalleClienteEliminar_Click"/>
                                        <Button Content="Fusionar con otra cuenta"
                                                Padding="12,8"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnDetalleClienteFusionar_Click"/>
                                    </StackPanel>
                                </StackPanel>
                            </ScrollViewer>

                            <!-- Columna derecha: Cuenta Corriente / Vehículos -->
                            <Grid Grid.Column="1">
                                <!-- Tab Cuenta Corriente -->
                                <Grid x:Name="GridMensualDetalleCuenta" Visibility="Visible">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Balance y Próximo Cargo -->
                                    <Grid Grid.Row="0" Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Balance"
                                                       FontSize="14"
                                                       FontWeight="SemiBold"
                                                       Foreground="#1F2937"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock x:Name="TxtMensualBalance"
                                                       FontSize="22"
                                                       FontWeight="Bold"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Próximo Cargo:"
                                                       FontSize="14"
                                                       FontWeight="SemiBold"
                                                       Foreground="#1F2937"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock x:Name="TxtMensualProximoCargo"
                                                       FontSize="16"
                                                       FontWeight="SemiBold"
                                                       Foreground="#1F2937"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Botones de acción -->
                                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                                        <Button Content="Crear Cargo"
                                                Padding="12,6"
                                                Margin="0,0,8,0"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnCrearCargoMensual_Click"/>
                                        <Button Content="Ingresar Pago"
                                                Padding="12,6"
                                                Margin="0,0,8,0"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnIngresarPagoMensual_Click"/>
                                        <Button x:Name="BtnPagoAdelantadoMensual"
                                                Content="Pago Adelantado"
                                                Padding="12,6"
                                                Margin="0,0,8,0"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnPagoAdelantadoMensual_Click"/>
                                        <Button Content="Ajustar"
                                                Padding="12,6"
                                                Margin="0,0,8,0"
                                                Background="#1E3A8A"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"
                                                Click="BtnAjusteMensual_Click"/>
                                    </StackPanel>

                                    <!-- Tabla de movimientos -->
                                    <DataGrid x:Name="DataGridMensualesMovimientos"
                                              Grid.Row="2"
                                              AutoGenerateColumns="False"
                                              HeadersVisibility="Column"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              IsReadOnly="True"
                                              SelectionMode="Single"
                                              RowBackground="White"
                                              AlternatingRowBackground="#F9FAFB"
                                              BorderThickness="0"
                                              GridLinesVisibility="Horizontal"
                                              ColumnHeaderHeight="32"
                                              RowHeight="34"
                                              LoadingRow="DataGridMensualesMovimientos_LoadingRow">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha, StringFormat=dd/MM/yy HH:mm}" Width="120"/>
                                            <DataGridTextColumn Header="Descripción" Binding="{Binding Descripcion}" Width="*"/>
                                            <DataGridTemplateColumn Header="Importe" Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock x:Name="TxtImporte" 
                                                                   Text="{Binding Importe, StringFormat={}{0:$#,0.00}}" 
                                                                   HorizontalAlignment="Right"
                                                                   VerticalAlignment="Center"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Balance" Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock x:Name="TxtBalance" 
                                                                   Text="{Binding BalanceResultante, StringFormat={}{0:$#,0.00}}" 
                                                                   HorizontalAlignment="Right"
                                                                   VerticalAlignment="Center"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>

                                <!-- Tab Vehículos -->
                                <Grid x:Name="GridMensualDetalleVehiculos" Visibility="Collapsed">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="350"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Columna izquierda: Detalle del vehículo -->
                                    <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,15,0">
                                        <StackPanel>
                                            <TextBlock Text="Vehículo"
                                                       FontSize="14"
                                                       FontWeight="Bold"
                                                       Foreground="#1F2937"
                                                       Margin="0,0,0,12"/>
                                            
                                            <StackPanel Margin="0,0,0,15">
                                                <TextBlock Text="Matrícula:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                                <TextBlock x:Name="TxtDetalleVehiculoMatricula" FontSize="13" Foreground="#3B82F6" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                                
                                                <TextBlock Text="Marca/Modelo:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                                <TextBlock x:Name="TxtDetalleVehiculoMarcaModelo" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                                
                                                <TextBlock Text="Categoría:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                                <TextBlock x:Name="TxtDetalleVehiculoCategoria" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                                
                                                <TextBlock Text="Tarifa:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                                <TextBlock x:Name="TxtDetalleVehiculoTarifa" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8"/>
                                                
                                                <TextBlock Text="Plaza / Ubicación:" FontSize="12" Foreground="#6B7280" Margin="0,0,0,2"/>
                                                <TextBlock x:Name="TxtDetalleVehiculoUbicacion" FontSize="13" Foreground="#1F2937" Margin="0,0,0,8" Text="Sin ubicación"/>
                                            </StackPanel>
                                            
                                            <!-- Nota -->
                                            <TextBlock Text="Nota"
                                                       FontSize="14"
                                                       FontWeight="Bold"
                                                       Foreground="#1F2937"
                                                       Margin="0,0,0,8"/>
                                            <TextBox x:Name="TxtDetalleVehiculoNota"
                                                     Height="80"
                                                     TextWrapping="Wrap"
                                                     AcceptsReturn="True"
                                                     VerticalScrollBarVisibility="Auto"
                                                     BorderBrush="#D1D5DB"
                                                     BorderThickness="1"
                                                     Padding="8"
                                                     Margin="0,0,0,15"
                                                     Text="Escriba aqui cualquier nota..."/>
                                            
                                            <!-- Botones de acción -->
                                            <StackPanel>
                                                <Button Content="Editar"
                                                        Padding="12,8"
                                                        Margin="0,0,0,8"
                                                        Background="#1E3A8A"
                                                        Foreground="White"
                                                        BorderThickness="1"
                                                        BorderBrush="#1E3A8A"
                                                        Cursor="Hand"
                                                        Click="BtnDetalleVehiculoEditar_Click"/>
                                                <Button Content="Seleccionar Ubicación"
                                                        Padding="12,8"
                                                        Margin="0,0,0,8"
                                                        Background="White"
                                                        Foreground="#1E3A8A"
                                                        BorderThickness="1"
                                                        BorderBrush="#1E3A8A"
                                                        Cursor="Hand"
                                                        Click="BtnDetalleVehiculoSeleccionarUbicacion_Click"/>
                                                <Button Content="Eliminar"
                                                        Padding="12,8"
                                                        Margin="0,0,0,8"
                                                        Background="White"
                                                        Foreground="#1E3A8A"
                                                        BorderThickness="1"
                                                        BorderBrush="#1E3A8A"
                                                        Cursor="Hand"
                                                        Click="BtnDetalleVehiculoEliminar_Click"/>
                                                <Button Content="Imprimir Código de Presencia"
                                                        Padding="12,8"
                                                        Background="White"
                                                        Foreground="#1E3A8A"
                                                        BorderThickness="1"
                                                        BorderBrush="#1E3A8A"
                                                        Cursor="Hand"
                                                        Click="BtnDetalleVehiculoImprimirCodigo_Click"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </ScrollViewer>
                                    
                                    <!-- Columna derecha: Tabla de vehículos -->
                                    <Grid Grid.Column="1">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Botón Agregar Vehículo en la parte superior derecha -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,10">
                                            <Button Content="Agregar Vehículo"
                                                    Padding="12,6"
                                                    Background="#1E3A8A"
                                                    Foreground="White"
                                                    BorderThickness="0"
                                                    Cursor="Hand"
                                                    Click="BtnAgregarVehiculoDesdeDetalle_Click"/>
                                        </StackPanel>
                                        
                                        <!-- Tabla de vehículos -->
                                        <DataGrid x:Name="DataGridMensualDetalleVehiculos"
                                                  Grid.Row="1"
                                                  AutoGenerateColumns="False"
                                                  HeadersVisibility="Column"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  SelectionMode="Single"
                                                  RowBackground="White"
                                                  AlternatingRowBackground="#F9FAFB"
                                                  BorderThickness="0"
                                                  GridLinesVisibility="Horizontal"
                                                  ColumnHeaderHeight="32"
                                                  RowHeight="34"
                                                  SelectionChanged="DataGridMensualDetalleVehiculos_SelectionChanged">
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn Header="Matrícula" Width="120">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Matricula, StringFormat={}#{0}}" VerticalAlignment="Center"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Marca/Modelo" Binding="{Binding MarcaModeloDisplay}" Width="*"/>
                                                <DataGridTextColumn Header="Fecha Inicio" Binding="{Binding FechaCreacion, StringFormat={}{0:dd/MM/yyyy}}" Width="120"/>
                                                <DataGridTemplateColumn Header="Ubicación" Width="120">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Ubicacion}" VerticalAlignment="Center">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Text" Value="{Binding Ubicacion}"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Ubicacion}" Value="{x:Null}">
                                                                                <Setter Property="Text" Value=""/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding Ubicacion}" Value="">
                                                                                <Setter Property="Text" Value=""/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Tarifa" Binding="{Binding TarifaNombre}" Width="120"/>
                                                <DataGridTextColumn Header="Valor Mensual" Binding="{Binding ValorMensual, StringFormat={}{0:$#,0.00}}" Width="120"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>

            <!-- Panel de Tickets Abiertos -->
            <Grid x:Name="PanelTicketsAbiertos" Visibility="Visible" Grid.Row="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Lista de tickets arriba -->
                <ScrollViewer Grid.Row="0"
                              VerticalScrollBarVisibility="Auto"
                              Padding="20">
                    <Grid>
                        <ItemsControl x:Name="ItemsTickets">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel IsItemsHost="True" Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border x:Name="BorderTicket"
                                            Background="#D6E9FF"
                                            BorderBrush="#8BB9F1"
                                            BorderThickness="1.2"
                                            CornerRadius="6"
                                            Margin="0,0,10,12"
                                            Padding="0"
                                            Width="260"
                                            Loaded="BorderTicket_Loaded">
                                        <Grid>
                                            <Grid.Resources>
                                                <BooleanToVisibilityConverter x:Key="BoolToVis"/>
                                            </Grid.Resources>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Sección superior azul (hasta la matrícula) -->
                                            <StackPanel Grid.Row="0" Background="#C2DDFA" Margin="0">
                                                <Grid Margin="10,10,10,4">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center">
                                                        <Border Width="32" Height="32" CornerRadius="4" Background="#A4CAF7" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <TextBlock Text="" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" Foreground="#1E3A8A"/>
                                                        </Border>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="8,0,0,0" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding CategoriaNombre}" FontSize="13" FontWeight="Bold" Foreground="#1E3A8A"/>
                                                        <TextBlock Text="{Binding TarifaNombre}" FontSize="11" Foreground="#1E3A8A"/>
                                                    </StackPanel>
                                                    <TextBlock Grid.Column="2"
                                                               x:Name="TxtTiempo"
                                                               FontSize="13"
                                                               Foreground="#0F172A"
                                                               VerticalAlignment="Center"
                                                               Text="--:--"/>
                                                </Grid>

                                                <TextBlock x:Name="TxtMatricula"
                                                           Text="{Binding Matricula}"
                                                           FontSize="20"
                                                           FontWeight="Bold"
                                                           Foreground="#1E3A8A"
                                                           TextAlignment="Center"
                                                           Margin="0,10,0,4"/>
                                                <TextBlock x:Name="TxtDescripcion"
                                                           Text="{Binding Descripcion}"
                                                           FontSize="12"
                                                           Foreground="#0F172A"
                                                           TextAlignment="Center"
                                                           TextWrapping="Wrap"/>
                                                <StackPanel x:Name="PanelCancelado"
                                                            Margin="0,6,0,0"
                                                            Visibility="{Binding EstaCancelado, Converter={StaticResource BoolToVis}}">
                                                    <TextBlock Text="CANCELADO"
                                                               FontSize="12"
                                                               FontWeight="Bold"
                                                               Foreground="#B91C1C"
                                                               TextAlignment="Center"/>
                                                    <TextBlock Text="{Binding MotivoCancelacion}"
                                                               FontSize="11"
                                                               Foreground="#B91C1C"
                                                               TextAlignment="Center"
                                                               TextWrapping="Wrap"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- Datos principales -->
                                            <StackPanel Grid.Row="1" Background="White" Margin="10">
                                                <Grid Margin="0,6,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="ENTRADA" FontSize="10" FontWeight="SemiBold" Foreground="#6B7280"/>
                                                        <TextBlock x:Name="TxtEntrada"
                                                                   Text="{Binding FechaEntrada, StringFormat='{}{0:dd/MM HH:mm}'}"
                                                                   FontSize="13"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="#111827"/>
                                                        <TextBlock Text="IMPORTE ACTUAL" FontSize="10" FontWeight="SemiBold" Foreground="#6B7280" Margin="0,6,0,0"/>
                                                        <TextBlock x:Name="TxtImporteActual"
                                                                   Text="$0,00"
                                                                   FontSize="13"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="#111827"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="TIEMPO" FontSize="10" FontWeight="SemiBold" Foreground="#6B7280" HorizontalAlignment="Right"/>
                                                        <TextBlock x:Name="TxtTiempoValor"
                                                                   Text="--:--"
                                                                   FontSize="13"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="#111827"
                                                                   HorizontalAlignment="Right"/>
                                                        <TextBlock Text="DEBE" FontSize="10" FontWeight="SemiBold" Foreground="#6B7280" Margin="0,6,0,0" HorizontalAlignment="Right"/>
                                                        <TextBlock x:Name="TxtDebe"
                                                                   Text="$0,00"
                                                                   FontSize="13"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="#D1432C"
                                                                   HorizontalAlignment="Right"/>
                                                    </StackPanel>
                                                </Grid>

                                                <StackPanel x:Name="PanelNota"
                                                        Margin="0,10,0,0">
                                                    <TextBlock Text="AGREGAR NOTA"
                                                               FontSize="10"
                                                               FontWeight="SemiBold"
                                                               Foreground="#6B7280"
                                                               TextAlignment="Center"/>
                                                    <TextBox x:Name="TxtNotaInline"
                                                             Text="{Binding NotaAdicional}"
                                                             Background="Transparent"
                                                             BorderThickness="0"
                                                             Padding="4,2"
                                                             FontSize="12"
                                                             TextAlignment="Center"
                                                             Foreground="#0F172A"
                                                             LostFocus="TxtNotaInline_LostFocus"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- Botones de acción -->
                                            <Grid x:Name="PanelAcciones"
                                                  Grid.Row="2"
                                                  Background="#D6E9FF"
                                                  Margin="0,-14,0,0"
                                                  HorizontalAlignment="Stretch">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <Button Grid.Column="0"
                                                        HorizontalAlignment="Center"
                                                        Width="26" Height="26"
                                                        Background="Transparent"
                                                        BorderBrush="#1E3A8A"
                                                        BorderThickness="1"
                                                        Content=""
                                                        FontFamily="Segoe MDL2 Assets"
                                                        FontSize="13"
                                                        Tag="{Binding}"
                                                        Click="BtnEditarTicket_Click"/>

                                                <Button Grid.Column="1"
                                                        HorizontalAlignment="Center"
                                                        Width="26" Height="26"
                                                        Background="Transparent"
                                                        BorderBrush="#1E3A8A"
                                                        BorderThickness="1"
                                                        Content=""
                                                        FontFamily="Segoe MDL2 Assets"
                                                        FontSize="13"
                                                        Tag="{Binding}"
                                                        Click="BtnReimprimirTicket_Click"/>

                                                <Button Grid.Column="2"
                                                        HorizontalAlignment="Center"
                                                        Width="26" Height="26"
                                                        Background="Transparent"
                                                        BorderBrush="#1E3A8A"
                                                        BorderThickness="1"
                                                        Content=""
                                                        FontFamily="Segoe MDL2 Assets"
                                                        FontSize="13"
                                                        Tag="{Binding}"
                                                        Click="BtnCancelarTicket_Click"/>
                                            </Grid>

                                            <!-- Botón cerrar -->
                                            <Border x:Name="PanelCerrar"
                                                    Grid.Row="3"
                                                    Background="#D6E9FF"
                                                    Padding="8,6,8,8">
                                                <Button Content="Cerrar"
                                                        Height="34"
                                                        FontSize="13"
                                                        Background="Transparent"
                                                        BorderBrush="#1E3A8A"
                                                        BorderThickness="1"
                                                        Foreground="#1E3A8A"
                                                        Tag="{Binding}"
                                                        Click="BtnCerrarTicket_Click"/>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <!-- Mensaje cuando no hay tickets -->
                        <TextBlock x:Name="TxtNoHayTickets"
                                   Text="Sin Tickets"
                                   FontSize="16"
                                   Foreground="#9CA3AF"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,100,0,0"
                                   Visibility="Collapsed"/>
                    </Grid>
                </ScrollViewer>
                
                <!-- Contadores de estadísticas (abajo, pegados al footer) -->
                <StackPanel Grid.Row="1" 
                            Orientation="Horizontal" 
                            HorizontalAlignment="Center"
                            Margin="0,15,0,0"
                            x:Name="PanelContadoresInicio">
                    <!-- Los contadores se generarán dinámicamente -->
                </StackPanel>
            </Grid>

            <!-- Panel de Tickets Cerrados -->
            <Grid x:Name="PanelTicketsCerrados" Visibility="Collapsed" Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Filtros -->
                <Border Grid.Column="0"
                        Background="#F8FAFC"
                        BorderBrush="#E5E7EB"
                        BorderThickness="0,0,1,0"
                        Padding="16">
                    <StackPanel KeyDown="PopupCrearTicket_KeyDown">
                        <TextBlock Text="Filtros"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Foreground="#1F2937"
                                   Margin="0,0,0,12"/>

                        <TextBlock Text="Categoría"
                                   FontSize="12"
                                   Foreground="#4B5563"
                                   Margin="0,0,0,4"/>
                        <ComboBox x:Name="CmbFiltroCategoriaCerrados"
                                  Height="34"
                                  Padding="8,4"
                                  SelectionChanged="CmbFiltroCerrados_Changed"/>

                        <TextBlock Text="Abierto por"
                                   FontSize="12"
                                   Foreground="#4B5563"
                                   Margin="0,12,0,4"/>
                        <ComboBox x:Name="CmbFiltroAbiertoPor"
                                  Height="34"
                                  Padding="8,4"
                                  SelectionChanged="CmbFiltroCerrados_Changed"/>

                        <TextBlock Text="Cerrado por"
                                   FontSize="12"
                                   Foreground="#4B5563"
                                   Margin="0,12,0,4"/>
                        <ComboBox x:Name="CmbFiltroCerradoPor"
                                  Height="34"
                                  Padding="8,4"
                                  SelectionChanged="CmbFiltroCerrados_Changed"/>

                        <TextBlock Text="Tipo de Tickets"
                                   FontSize="12"
                                   Foreground="#4B5563"
                                   Margin="0,12,0,4"/>
                        <ComboBox x:Name="CmbFiltroTipoTicket"
                                  Height="34"
                                  Padding="8,4"
                                  SelectionChanged="CmbFiltroCerrados_Changed"/>

                        <TextBlock Text="Cancelación"
                                   FontSize="12"
                                   Foreground="#4B5563"
                                   Margin="0,12,0,4"/>
                        <ComboBox x:Name="CmbFiltroCancelacion"
                                  Height="34"
                                  Padding="8,4"
                                  SelectionChanged="CmbFiltroCerrados_Changed"/>
                    </StackPanel>
                </Border>

                <!-- Tabla y controles -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Barra superior -->
                    <StackPanel Grid.Row="0"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                Margin="0,0,12,8"
                                VerticalAlignment="Center">
                        <TextBox x:Name="TxtBuscarCerrados"
                                 Width="260"
                                 Height="32"
                                 Padding="8,4"
                                 Foreground="#374151"
                                 Background="White"
                                 BorderBrush="#D1D5DB"
                                 BorderThickness="1"
                                 TextChanged="TxtBuscarCerrados_TextChanged"/>
                        <Button Content="Exportar"
                                Height="32"
                                Padding="12,0"
                                Background="#3B82F6"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="BtnExportarCerrados_Click"/>
                    </StackPanel>

                    <!-- Tabla -->
                    <DataGrid x:Name="DataGridCerrados"
                              Grid.Row="1"
                              AutoGenerateColumns="False"
                              HeadersVisibility="Column"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              MouseDoubleClick="DataGridCerrados_MouseDoubleClick"
                              RowBackground="White"
                              AlternatingRowBackground="#F9FAFB"
                              BorderBrush="#E5E7EB"
                              BorderThickness="1"
                              GridLinesVisibility="Horizontal"
                              ColumnHeaderHeight="32"
                              RowHeight="30"
                              Margin="0,0,12,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="40"/>
                            <DataGridTextColumn Header="Fecha" Binding="{Binding FechaEntrada, StringFormat={}{0:dd/MM/yy HH:mm}}" Width="100"/>
                            <DataGridTextColumn Header="Matrícula" Binding="{Binding Matricula}" Width="90"/>
                            <DataGridTextColumn Header="Categoría" Binding="{Binding CategoriaNombre}" Width="90"/>
                            <DataGridTextColumn Header="Tipo" Binding="{Binding TarifaNombre}" Width="80"/>
                            <DataGridTextColumn Header="Desde" Binding="{Binding FechaEntrada, StringFormat={}{0:HH:mm (dd/MM)}}" Width="110"/>
                            <DataGridTextColumn Header="Hasta" Binding="{Binding FechaSalida, StringFormat={}{0:HH:mm (dd/MM)}}" Width="110"/>
                            <DataGridTextColumn Header="Cancelado en" Binding="{Binding FechaCancelacion, StringFormat={}{0:HH:mm (dd/MM)}}" Width="110"/>
                            <DataGridTextColumn Header="Tiempo Total" Binding="{Binding TiempoTotalDisplay}" Width="90"/>
                            <DataGridTextColumn Header="Observación" Binding="{Binding ObservacionDisplay}" Width="140"/>
                            <DataGridTextColumn Header="Notas" Binding="{Binding NotaAdicional}" Width="160"/>
                            <DataGridTextColumn Header="Motivo" Binding="{Binding MotivoCancelacion}" Width="160"/>
                            <DataGridTextColumn Header="Importe" Binding="{Binding MontoDisplay}" Width="80"/>
                            <DataGridTextColumn Header="Pagado" Binding="{Binding MontoDisplay}" Width="80"/>
                            <DataGridTextColumn Header="Abierto por" Binding="{Binding AdminCreadorNombre}" Width="100"/>
                            <DataGridTextColumn Header="Cerró / Canceló" Binding="{Binding AdminCerradorNombre}" Width="110"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Totales -->
                    <StackPanel Grid.Row="2"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                Margin="0,8,12,8">
                        <StackPanel Margin="0,0,32,0">
                            <TextBlock Text="Tickets Cerrados"
                                       FontSize="12"
                                       Foreground="#4B5563"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="TxtTotalCerrados"
                                       Text="0"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#0F172A"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,32,0">
                            <TextBlock Text="Cancelados"
                                       FontSize="12"
                                       Foreground="#4B5563"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="TxtTotalCancelados"
                                       Text="0"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#0F172A"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,32,0">
                            <TextBlock Text="Tickets x Hora"
                                       FontSize="12"
                                       Foreground="#4B5563"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="TxtTotalHora"
                                       Text="0"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#0F172A"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel>
                            <TextBlock Text="Importe Total"
                                       FontSize="12"
                                       Foreground="#4B5563"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="TxtImporteTotalCerrados"
                                       Text="$0.00"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#0F172A"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Grid>

            <!-- Panel de Entradas / Salidas -->
            <Grid x:Name="PanelEntradasSalidas" Visibility="Collapsed" Grid.Row="0" Margin="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Calendario para filtrar por fecha -->
                <Border Grid.Column="0"
                        Margin="12"
                        Background="White"
                        BorderBrush="#E5E7EB"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12">
                    <Calendar x:Name="CalendarEntradasSalidas"
                              SelectionMode="SingleDate"
                              SelectedDatesChanged="CalendarEntradasSalidas_SelectedDateChanged"/>
                </Border>

                <!-- Tabla de movimientos -->
                <Border Grid.Column="1"
                        Margin="12,12,12,12"
                        Background="White"
                        BorderBrush="#E5E7EB"
                        BorderThickness="1"
                        CornerRadius="8">
                    <DataGrid x:Name="DataGridEntradasSalidas"
                              AutoGenerateColumns="False"
                              HeadersVisibility="Column"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              RowBackground="White"
                              AlternatingRowBackground="#F9FAFB"
                              BorderThickness="0"
                              GridLinesVisibility="Horizontal"
                              ColumnHeaderHeight="32"
                              RowHeight="34"
                              Margin="0"
                              SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="E/S" Width="55">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding Icono}"
                                                       Foreground="{Binding IconoColor}"
                                                       FontFamily="Segoe MDL2 Assets"
                                                       FontSize="16"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="Fecha" Width="100" SortMemberPath="FechaHora">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Fecha}"
                                                   FontSize="12"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#22C55E"/>
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding EsEntrada}" Value="False">
                                                            <Setter Property="Foreground" Value="#EF4444"/>
                                                            <Setter Property="TextAlignment" Value="Left"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="Hora" Width="80" SortMemberPath="FechaHora">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Hora}"
                                                   FontSize="12"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#22C55E"/>
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding EsEntrada}" Value="False">
                                                            <Setter Property="Foreground" Value="#EF4444"/>
                                                            <Setter Property="TextAlignment" Value="Left"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="Matrícula" Binding="{Binding Matricula}" Width="120">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Header="Imagen" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Image Source="{Binding ImagenPath}"
                                               Height="32"
                                               Width="48"
                                               Stretch="UniformToFill">
                                            <Image.Style>
                                                <Style TargetType="Image">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ImagenPath}" Value="{x:Null}">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding ImagenPath}" Value="">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Image.Style>
                                        </Image>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Categoría" Binding="{Binding Categoria}" Width="110">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Ticket ID" Binding="{Binding TicketId}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="TextAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Mensual ID" Binding="{Binding MensualId}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="TextAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Operador" Binding="{Binding Operador}" Width="140">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>

            <!-- Footer con botones -->
            <Border Grid.Row="1" 
                    x:Name="FooterEstadisticas"
                    Background="White"
                    BorderBrush="#E5E7EB"
                    BorderThickness="0,1,0,0"
                    Padding="20,15"
                    x:FieldModifier="public">
                <!-- Botones de acción organizados por tarifa -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            x:Name="PanelBotonesTarifas">
                    <!-- Los botones se generarán dinámicamente por tarifa -->
                </StackPanel>
            </Border>
        </Grid>
        
        <!-- Popup flotante para el menú del usuario -->
        <Popup x:Name="PopupMenuUsuario"
               Placement="Bottom"
               PlacementTarget="{Binding ElementName=TxtNombreUsuario}"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               HorizontalOffset="-40">
            <Border Background="White"
                    BorderBrush="#D1D5DB"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="0"
                    MinWidth="200"
                    Effect="{StaticResource ShadowEffect}">
                <StackPanel>
                    <Button Content="Cambiar Contraseña" 
                            Height="38"
                            FontSize="13"
                            Background="Transparent"
                            Foreground="#334155"
                            BorderThickness="0"
                            Padding="15,0"
                            HorizontalContentAlignment="Left"
                            Cursor="Hand"
                            Click="BtnCambiarPassword_Click"
                            MouseEnter="BtnMenuUsuario_MouseEnter"
                            MouseLeave="BtnMenuUsuario_MouseLeave"/>
                    <Button Content="Cambiar email de recuperación" 
                            Height="38"
                            FontSize="13"
                            Background="Transparent"
                            Foreground="#334155"
                            BorderThickness="0"
                            Padding="15,0"
                            HorizontalContentAlignment="Left"
                            Cursor="Hand"
                            Click="BtnCambiarEmail_Click"
                            MouseEnter="BtnMenuUsuario_MouseEnter"
                            MouseLeave="BtnMenuUsuario_MouseLeave"/>
                    <Border Height="1" Background="#E5E7EB" Margin="0"/>
                    <Button Content="Cerrar Sesión" 
                            Height="38"
                            FontSize="13"
                            Background="Transparent"
                            Foreground="#334155"
                            BorderThickness="0"
                            Padding="15,0"
                            HorizontalContentAlignment="Left"
                            Cursor="Hand"
                            Click="BtnCerrarSesion_Click"
                            MouseEnter="BtnMenuUsuario_MouseEnter"
                            MouseLeave="BtnMenuUsuario_MouseLeave"/>
                </StackPanel>
            </Border>
        </Popup>

        <!-- Popup flotante para crear ticket -->
        <Popup x:Name="PopupCrearTicket"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="Transparent"
                    Padding="0"
                    MouseLeftButtonDown="PopupCrearTicket_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E90FF"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupCrearTicket_ContentClick">
                    <StackPanel>
                        <!-- Header -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="TxtCrearTicketTitulo"
                                       Text="Ingreso"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupCrearTicket_Click"/>
                        </Grid>

                        <!-- Categoría -->
                        <TextBlock x:Name="TxtCrearTicketCategoria"
                                   Text="Categoría"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#1E3A8A"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,6"/>

                        <!-- Indicador de matrícula -->
                        <TextBlock Text="Ingrese la Matrícula"
                                   FontSize="14"
                                   Foreground="#4B5563"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8"/>

                        <!-- Matrícula -->
                        <Border BorderBrush="#1E90FF"
                                BorderThickness="1.5"
                                CornerRadius="4"
                                Background="White"
                                Margin="0,0,0,12">
                            <TextBox x:Name="TxtCrearTicketMatricula"
                                     Height="56"
                                     FontSize="28"
                                     FontWeight="Bold"
                                     Foreground="Black"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     VerticalContentAlignment="Center"
                                     HorizontalContentAlignment="Center"
                                     CharacterCasing="Upper"
                                     TextChanged="TxtCrearTicketMatricula_TextChanged"/>
                        </Border>

                        <!-- Descripción -->
                        <TextBlock Text="Descripción"
                                   FontSize="13"
                                   Foreground="#4B5563"
                                   Margin="0,0,0,6"/>
                        <TextBox x:Name="TxtCrearTicketDescripcion"
                                 Height="40"
                                 Padding="10,8"
                                 FontSize="13"
                                 BorderBrush="#D1D5DB"
                                 BorderThickness="1"
                                 Background="White"
                                 Margin="0,0,0,12"/>

                        <!-- Ingreso previo -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <CheckBox x:Name="ChkIngresoPrevio"
                                      Content="Ingreso previo"
                                      VerticalAlignment="Center"
                                      Checked="ChkIngresoPrevio_Checked"
                                      Unchecked="ChkIngresoPrevio_Unchecked"/>
                        </StackPanel>

                        <!-- Fecha/Hora ingreso previo -->
                        <StackPanel x:Name="PanelIngresoPrevio" Visibility="Collapsed" Margin="0,0,0,12">
                            <TextBlock Text="Ingreso"
                                       FontSize="13"
                                       Foreground="#4B5563"
                                       Margin="0,0,0,6"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="8"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="8"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <DatePicker x:Name="DpIngresoPrevio"
                                            Grid.Column="0"
                                            Height="32"
                                            FontSize="12"
                                            BorderBrush="#D1D5DB"
                                            BorderThickness="1"
                                            SelectedDate="{x:Null}"/>
                                <ComboBox x:Name="CmbHoraIngreso"
                                          Grid.Column="2"
                                          Height="32"
                                          FontSize="12"
                                          BorderBrush="#D1D5DB"
                                          BorderThickness="1"
                                          VerticalContentAlignment="Center"/>
                                <ComboBox x:Name="CmbMinutoIngreso"
                                          Grid.Column="4"
                                          Height="32"
                                          FontSize="12"
                                          BorderBrush="#D1D5DB"
                                          BorderThickness="1"
                                          VerticalContentAlignment="Center"/>
                            </Grid>
                        </StackPanel>

                        <!-- Botón crear -->
                        <Button x:Name="BtnCrearTicketConfirmar"
                                Content="Ingresar"
                                Height="42"
                                FontSize="15"
                                FontWeight="SemiBold"
                                Background="#1E90FF"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="BtnCrearTicketConfirmar_Click"/>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Cambiar Contraseña -->
        <Popup x:Name="PopupCambiarPassword"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupCambiarPassword_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupCambiarPassword_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Cambiar contraseña"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupCambiarPassword_Click"/>
                        </Grid>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Contraseña actual"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtPasswordActual"
                                         Height="38"
                                         Padding="10,8"
                                         FontSize="13"
                                         VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Nueva contraseña"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtPasswordNueva"
                                         Height="38"
                                         Padding="10,8"
                                         FontSize="13"
                                         VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Repetir nueva contraseña"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtPasswordNuevaConfirm"
                                         Height="38"
                                         Padding="10,8"
                                         FontSize="13"
                                         VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnCancelarCambiarPassword_Click"/>
                            <Button Content="Guardar"
                                    Padding="14,6"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnGuardarCambiarPassword_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Cambiar Email -->
        <Popup x:Name="PopupCambiarEmail"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupCambiarEmail_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupCambiarEmail_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Email de recuperación"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupCambiarEmail_Click"/>
                        </Grid>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Nuevo email"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtEmailNuevo"
                                     Height="38"
                                     Padding="10,8"
                                     FontSize="13"
                                     VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Repetir email"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtEmailNuevoConfirm"
                                     Height="38"
                                     Padding="10,8"
                                     FontSize="13"
                                     VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Contraseña actual"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtEmailPassword"
                                         Height="38"
                                         Padding="10,8"
                                         FontSize="13"
                                         VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnCancelarCambiarEmail_Click"/>
                            <Button Content="Guardar"
                                    Padding="14,6"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnGuardarCambiarEmail_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Nuevo Cliente Mensual -->
        <Popup x:Name="PopupClienteMensual"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupClienteMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="420"
                        MaxWidth="480"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupClienteMensual_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="TxtTituloClienteMensual"
                                       Text="Nuevo Cliente"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupClienteMensual_Click"/>
                        </Grid>

                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="TxtClienteNombre"
                                     Grid.Column="0"
                                     Height="32"/>
                            <TextBox x:Name="TxtClienteApellido"
                                     Grid.Column="2"
                                     Height="32"/>
                        </Grid>
                        <TextBox x:Name="TxtClienteWhatsapp"
                                 Height="32"
                                 Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtClienteEmail"
                                 Height="32"
                                 Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtClienteDNI"
                                 Height="32"
                                 Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtClienteCUIT"
                                 Height="32"
                                 Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtClienteDireccion"
                                 Height="32"
                                 Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtClienteNota"
                                 Height="60"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"/>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,10,0,0">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnCancelarClienteMensual_Click"/>
                            <Button Content="Guardar"
                                    Padding="16,6"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnGuardarClienteMensual_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Agregar Vehículo Mensual -->
        <Popup x:Name="PopupVehiculoMensual"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupVehiculoMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="420"
                        MaxWidth="480"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupVehiculoMensual_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="TxtTituloVehiculoMensual"
                                       Text="Agregar Vehículo"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupVehiculoMensual_Click"/>
                        </Grid>

                        <TextBox x:Name="TxtVehiculoMatriculaOld"
                                 Height="36"
                                 FontSize="18"
                                 FontWeight="Bold"
                                 CharacterCasing="Upper"
                                 HorizontalContentAlignment="Center"
                                 Margin="0,0,0,10"/>
                        <TextBox x:Name="TxtVehiculoMarcaModeloOld"
                                 Height="32"
                                 Margin="0,0,0,8"/>

                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox x:Name="CmbVehiculoCategoriaOld"
                                      Grid.Column="0"
                                      Height="32"/>
                            <ComboBox x:Name="CmbVehiculoTarifaOld"
                                      Grid.Column="2"
                                      Height="32"/>
                        </Grid>

                        <CheckBox x:Name="ChkVehiculoPrecioDifOld"
                                  Content="Precio diferenciado"
                                  Margin="0,0,0,6"
                                  Checked="ChkVehiculoPrecioDif_Checked"
                                  Unchecked="ChkVehiculoPrecioDif_Checked"/>
                        <TextBox x:Name="TxtVehiculoPrecio"
                                 Height="32"
                                 Margin="0,0,0,8"
                                 IsEnabled="False"/>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,10,0,0">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnCancelarVehiculoMensual_Click"/>
                            <Button Content="Guardar"
                                    Padding="16,6"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnGuardarVehiculoMensual_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Movimiento Mensual (cargo/pago/ajuste/adelantado) -->
        <Popup x:Name="PopupMovimientoMensual"
               Visibility="Collapsed"
               StaysOpen="True"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupMovimientoMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="420"
                        MaxWidth="480"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupMovimientoMensual_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="TxtTituloMovimientoMensual"
                                       Text="Nuevo Movimiento"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupMovimientoMensual_Click"/>
                        </Grid>

                        <TextBlock Text="Importe"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="#1F2937"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="TxtMovimientoImporte"
                                 Height="38"
                                 FontSize="16"
                                 FontWeight="Bold"
                                 HorizontalContentAlignment="Center"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Detalle"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="#1F2937"
                                   Margin="0,0,0,4"/>
                        <TextBox x:Name="TxtMovimientoDetalle"
                                 Height="60"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 Margin="0,0,0,10"/>

                        <!-- Sección de Forma de Pago (solo para Pagos) -->
                        <StackPanel x:Name="StackPanelFormaPagoMensual" 
                                    Visibility="Collapsed"
                                    Margin="0,0,0,10">
                            <TextBlock Text="Medio de Pago"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,8"/>
                            <ListBox x:Name="ListBoxFormasPagoMensual"
                                     Height="120"
                                     BorderBrush="#D1D5DB"
                                     BorderThickness="1"
                                     SelectionMode="Single"
                                     DisplayMemberPath="Nombre"/>
                        </StackPanel>

                        <!-- Sección de Impresión de Comprobante (solo para Pagos) -->
                        <StackPanel x:Name="StackPanelReciboMensual" 
                                    Visibility="Collapsed"
                                    Margin="0,0,0,10">
                            <TextBlock Text="Impresión de Comprobante"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal">
                                <RadioButton x:Name="RbMovimientoSinComprobante"
                                             Content="Sin Comprobante"
                                             IsChecked="True"
                                             Margin="0,0,16,0"/>
                                <RadioButton x:Name="RbMovimientoRecibo"
                                             Content="Recibo"/>
                            </StackPanel>
                        </StackPanel>

                        <DatePicker x:Name="DpMovimientoMes"
                                    Margin="0,0,0,10"
                                    Visibility="Collapsed"/>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,10,0,0">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnMovimientoMensualCancelar_Click"/>
                            <Button x:Name="BtnMovimientoMensualGuardar"
                                    Content="Aceptar"
                                    Padding="16,6"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnMovimientoMensualGuardar_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Pago Adelantado -->
        <Popup x:Name="PopupPagoAdelantado"
               Visibility="Collapsed"
               StaysOpen="True"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupPagoAdelantado_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="0"
                        MinWidth="420"
                        MaxWidth="480"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupPagoAdelantado_ContentClick">
                    <StackPanel>
                        <!-- Header -->
                        <Border Background="#1E3A8A"
                                Padding="16,12"
                                CornerRadius="6,6,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Pago Adelantado"
                                           FontSize="18"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           VerticalAlignment="Center"/>
                                <Button Grid.Column="1"
                                        Content="✕"
                                        Width="28"
                                        Height="28"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Click="BtnCerrarPopupPagoAdelantado_Click"/>
                            </Grid>
                        </Border>
                        
                        <!-- Content -->
                        <StackPanel Margin="20">
                            <TextBlock Text="Pago Adelantado"
                                       FontSize="16"
                                       FontStyle="Italic"
                                       Foreground="#6B7280"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="Esta funcionalidad le permite realizar pagos adelantados evitando procesar los pagos hasta la fecha indicada."
                                       FontSize="12"
                                       FontStyle="Italic"
                                       Foreground="#6B7280"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,20"/>
                            
                            <TextBlock Text="Seleccione hasta que mes (incluido) desea realizar el pago"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,8"/>
                            
                            <DatePicker x:Name="DpPagoAdelantadoMes"
                                        SelectedDateChanged="DpPagoAdelantadoMes_SelectedDateChanged"
                                        Margin="0,0,0,20"/>
                            
                            <Button Content="Continuar"
                                    Padding="16,10"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    HorizontalAlignment="Stretch"
                                    Click="BtnPagoAdelantadoContinuar_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Detalle Cliente Mensual -->
        <Popup x:Name="PopupDetalleClienteMensual"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupDetalleClienteMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="820"
                        MaxWidth="920"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupDetalleClienteMensual_ContentClick">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Grid Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock x:Name="TxtPopupDetalleClienteNombre"
                                           Text="Cliente"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="#1E3A8A"/>
                                <TextBlock x:Name="TxtPopupDetalleClienteDireccion"
                                           FontSize="12"
                                           Foreground="#374151"/>
                            </StackPanel>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupDetalleClienteMensual_Click"/>
                        </Grid>

                        <!-- Acciones -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <Button Content="Crear Cargo"
                                    Padding="12,6"
                                    Margin="0,0,8,0"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCrearCargoMensual_Click"/>
                            <Button Content="Ingresar Pago"
                                    Padding="12,6"
                                    Margin="0,0,8,0"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnIngresarPagoMensual_Click"/>
                            <Button Content="Pago Adelantado"
                                    Padding="12,6"
                                    Margin="0,0,8,0"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnPagoAdelantadoMensual_Click"/>
                            <Button Content="Ajustar"
                                    Padding="12,6"
                                    Margin="0,0,8,0"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnAjusteMensual_Click"/>
                            <Button Content="Agregar Vehículo"
                                    Padding="12,6"
                                    Background="#10B981"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnAgregarVehiculoDesdeDetalle_Click"/>
                        </StackPanel>

                        <!-- Balance -->
                        <Border Grid.Row="1" Grid.Column="1"
                                Background="#F8FAFC"
                                BorderBrush="#E5E7EB"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="10"
                                HorizontalAlignment="Right">
                            <StackPanel>
                                <TextBlock Text="Balance"
                                           FontSize="12"
                                           Foreground="#374151"/>
                                <TextBlock x:Name="TxtDetalleBalance"
                                           Text="$0.00"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="#16A34A"/>
                            </StackPanel>
                        </Border>

                        <!-- Movimientos -->
                        <DataGrid Grid.Row="2" Grid.ColumnSpan="2"
                                  x:Name="DataGridMovimientosMensuales"
                                  AutoGenerateColumns="False"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  IsReadOnly="True"
                                  RowBackground="White"
                                  AlternatingRowBackground="#F9FAFB"
                                  BorderThickness="0"
                                  GridLinesVisibility="Horizontal"
                                  ColumnHeaderHeight="32"
                                  RowHeight="32">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha, StringFormat={}{0:dd/MM/yy HH:mm}}" Width="120"/>
                                <DataGridTextColumn Header="Descripción" Binding="{Binding Descripcion}" Width="*"/>
                                <DataGridTextColumn Header="Tipo" Binding="{Binding Tipo}" Width="100"/>
                                <DataGridTextColumn Header="Importe" Binding="{Binding Importe, StringFormat={}{0:$#,0.00}}" Width="110"/>
                                <DataGridTextColumn Header="Balance" Binding="{Binding BalanceResultante, StringFormat={}{0:$#,0.00}}" Width="110"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Border>
        </Popup>

        <!-- Popup cerrar ticket por matrícula -->
        <Popup x:Name="PopupCerrarMatricula"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupCerrarMatricula_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupCerrarMatricula_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Cerrar ticket por matrícula"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupCerrarMatricula_Click"/>
                        </Grid>

                        <TextBlock Text="Ingrese la matrícula"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="#1F2937"
                                   Margin="0,0,0,6"/>
                        <TextBox x:Name="TxtCerrarMatricula"
                                 Height="44"
                                 FontSize="20"
                                 FontWeight="Bold"
                                 CharacterCasing="Upper"
                                 VerticalContentAlignment="Center"
                                 HorizontalContentAlignment="Center"
                                 BorderBrush="#1E3A8A"
                                 BorderThickness="1.5"
                                 Margin="0,0,0,12"
                                 KeyDown="TxtCerrarMatricula_KeyDown"
                                 TextChanged="TxtCerrarMatricula_TextChanged"/>

                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right">
                            <Button Content="Cancelar"
                                    Margin="0,0,10,0"
                                    Padding="14,6"
                                    Background="White"
                                    Foreground="#1F2937"
                                    BorderBrush="#D1D5DB"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Click="BtnCerrarMatriculaCancelar_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Cobrar/Cerrar ticket -->
        <Popup x:Name="PopupCobrarTicket"
               Visibility="Collapsed"
               StaysOpen="True"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000"
                    Padding="0"
                    MouseLeftButtonDown="PopupCobrarTicket_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="520"
                        MaxWidth="640"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupCobrarTicket_ContentClick">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <!-- Encabezado -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock x:Name="TxtCobrarTitulo"
                                           Text="CAJA"
                                           FontSize="18"
                                           FontWeight="Bold"
                                           Foreground="#1E3A8A"
                                           Margin="0,0,0,4"/>
                                <TextBlock x:Name="TxtCobrarResumen"
                                           FontSize="12"
                                           Foreground="#1F2937"/>
                            </StackPanel>
                            <Button Grid.Column="1"
                                    Content="✕"
                                    Width="28"
                                    Height="28"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Background="Transparent"
                                    Foreground="#1E3A8A"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnCerrarPopupCobrarTicket_Click"/>
                        </Grid>

                        <!-- Importe -->
                        <Border Grid.Row="1"
                                Background="#EFF6FF"
                                BorderBrush="#BFDBFE"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="12"
                                Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Importe"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#1E3A8A"/>
                                <TextBlock x:Name="TxtCobrarImporte"
                                           FontSize="28"
                                           FontWeight="Bold"
                                           Foreground="#1E3A8A"/>
                                <TextBlock x:Name="TxtCobrarPermanencia"
                                           FontSize="12"
                                           Foreground="#1F2937"/>
                            </StackPanel>
                        </Border>

                        <!-- Items y forma de pago -->
                        <Grid Grid.Row="2" Margin="0,0,0,12" x:Name="GridCobrarFormasPago">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Items"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#1F2937"
                                           Margin="0,0,0,6"/>
                                <ItemsControl x:Name="ItemsCobrarDetalle">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                <TextBlock Text="•"
                                                           Margin="0,0,6,0"/>
                                                <TextBlock Text="{Binding}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Margin="12,0,0,0">
                                <TextBlock Text="Seleccione la forma de pago"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Foreground="#1F2937"
                                           Margin="0,0,0,6"/>
                                <ListBox x:Name="ListBoxFormasPago"
                                         Height="150"
                                         BorderBrush="#CBD5E1"
                                         BorderThickness="1"
                                         DisplayMemberPath="Nombre"
                                         SelectionMode="Single"/>
                            </StackPanel>
                        </Grid>

                        <!-- Descripción -->
                        <StackPanel Grid.Row="3" Margin="0,0,0,12">
                            <TextBlock Text="Descripción"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtCobrarDescripcion"
                                     Height="60"
                                     TextWrapping="Wrap"
                                     VerticalScrollBarVisibility="Auto"
                                     BorderBrush="#CBD5E1"
                                     BorderThickness="1"/>
                        </StackPanel>

                        <!-- Opciones y botones -->
                        <Grid Grid.Row="4" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,14,0">
                                    <RadioButton x:Name="RbSinComprobante"
                                                 Content="Sin Comprobante"
                                                 IsChecked="True"/>
                                    <RadioButton x:Name="RbRecibo" Margin="10,0,0,0"
                                                 Content="Recibo"/>
                                </StackPanel>
                                <CheckBox x:Name="ChkSalidaInmediata"
                                          Content="Salida inmediata"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="Cancelar"
                                        Margin="0,0,10,0"
                                        Padding="14,8"
                                        Background="White"
                                        Foreground="#1F2937"
                                        BorderBrush="#D1D5DB"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Click="BtnCobrarCancelar_Click"/>
                                <Button Content="Cobrar"
                                        Padding="16,8"
                                        Background="#1E3A8A"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Click="BtnCobrarConfirmar_Click"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Nuevo Cliente Mensual -->
        <Popup x:Name="PopupNuevoClienteMensual"
               Visibility="Collapsed"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000" Padding="0" MouseLeftButtonDown="PopupNuevoClienteMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupNuevoClienteMensual_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Nuevo Cliente"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1" Content="✕" Width="28" Height="28" FontSize="14" FontWeight="Bold"
                                    Background="Transparent" Foreground="#1E3A8A" BorderThickness="0"
                                    Cursor="Hand" Click="BtnCerrarPopupNuevoClienteMensual_Click"/>
                        </Grid>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Nombre"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualNombre" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Apellido"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualApellido" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="WhatsApp"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualWhatsapp" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Email"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualEmail" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="DNI"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualDNI" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="CUIT/CUIL"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualCUIT" Height="34" />
                        </StackPanel>
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Dirección"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtClienteMensualDireccion" Height="34" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Cancelar" Margin="0,0,10,0" Padding="14,6" Background="White" Foreground="#1F2937"
                                    BorderBrush="#D1D5DB" BorderThickness="1" Cursor="Hand"
                                    Click="BtnCancelarNuevoClienteMensual_Click"/>
                            <Button Content="Guardar" Padding="16,6" Background="#1E3A8A" Foreground="White" BorderThickness="0"
                                    Cursor="Hand" Click="BtnGuardarNuevoClienteMensual_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup Nuevo Vehículo Mensual -->
        <Popup x:Name="PopupNuevoVehiculoMensual"
               Visibility="Collapsed"
               StaysOpen="True"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#99000000" Padding="0" MouseLeftButtonDown="PopupNuevoVehiculoMensual_BackdropClick">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="20"
                        MinWidth="380"
                        MaxWidth="460"
                        BorderBrush="#1E3A8A"
                        BorderThickness="2"
                        MouseLeftButtonDown="PopupNuevoVehiculoMensual_ContentClick">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Agregar Vehículo"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="#1E3A8A"
                                       HorizontalAlignment="Center"/>
                            <Button Grid.Column="1" Content="✕" Width="28" Height="28" FontSize="14" FontWeight="Bold"
                                    Background="Transparent" Foreground="#1E3A8A" BorderThickness="0"
                                    Cursor="Hand" Click="BtnCerrarPopupNuevoVehiculoMensual_Click"/>
                        </Grid>
                        <!-- Sección Vehículo -->
                        <TextBlock Text="Vehículo"
                                   FontSize="14"
                                   FontWeight="Bold"
                                   Foreground="#1F2937"
                                   Margin="0,0,0,12"/>
                        
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Cliente"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <ComboBox x:Name="CmbVehiculoCliente"
                                      Height="34"
                                      IsEnabled="False"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Matrícula"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtVehiculoMatricula" Height="34" CharacterCasing="Upper"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Marca/Modelo"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtVehiculoMarcaModelo" Height="34"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Categoría"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <ComboBox x:Name="CmbVehiculoCategoria" Height="34"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <TextBlock Text="Tarifa"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="#1F2937"
                                       Margin="0,0,0,4"/>
                            <ComboBox x:Name="CmbVehiculoTarifa" Height="34"/>
                        </StackPanel>
                        <StackPanel Margin="0,0,0,8">
                            <CheckBox x:Name="ChkVehiculoAlternativo" Content="Vehículo alternativo" Margin="0,0,0,8"/>
                            <StackPanel>
                                <CheckBox x:Name="ChkVehiculoPrecioDif" 
                                          Content="Precio diferenciado"
                                          Checked="ChkVehiculoPrecioDif_Checked"
                                          Unchecked="ChkVehiculoPrecioDif_Unchecked"/>
                            </StackPanel>
                            <StackPanel x:Name="StackPanelPrecioPersonalizado"
                                        Margin="0,8,0,0"
                                        Visibility="Collapsed">
                                <TextBlock Text="Monto"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Foreground="#1F2937"
                                           Margin="0,0,0,4"/>
                                <TextBox x:Name="TxtVehiculoPrecioPersonalizado"
                                         Height="34"
                                         IsEnabled="True"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Sección Generación del 1er cargo -->
                        <TextBlock Text="Generación del 1er cargo"
                                   FontSize="14"
                                   FontWeight="Bold"
                                   Foreground="#1F2937"
                                   Margin="0,12,0,8"/>
                        <TextBlock Text="Todos los días 1 de cada mes se generará el cargo mensual. ¿Cómo deseas aplicar el primer cargo hasta fin de mes?"
                                   FontSize="12"
                                   Foreground="#6B7280"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>
                        <StackPanel Margin="0,0,0,12">
                            <RadioButton x:Name="RbVehiculoBonificarFinMes"
                                         Content="Bonificar hasta fin de mes"
                                         GroupName="PrimerCargo"
                                         Margin="0,0,0,8"/>
                            <RadioButton x:Name="RbVehiculoCargoProporcional"
                                         Content="Proporcional"
                                         GroupName="PrimerCargo"
                                         IsChecked="True"
                                         Margin="0,0,0,8"/>
                            <RadioButton x:Name="RbVehiculoCargoMesCompleto"
                                         Content="Mes completo"
                                         GroupName="PrimerCargo"
                                         Margin="0,0,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Cancelar" Margin="0,0,10,0" Padding="14,6" Background="White" Foreground="#1F2937"
                                    BorderBrush="#D1D5DB" BorderThickness="1" Cursor="Hand"
                                    Click="BtnCancelarNuevoVehiculoMensual_Click"/>
                            <Button Content="Guardar" Padding="16,6" Background="#1E3A8A" Foreground="White" BorderThickness="0"
                                    Cursor="Hand" Click="BtnGuardarNuevoVehiculoMensual_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>

        <!-- Popup editar ticket -->
        <Popup x:Name="PopupEditarTicket"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="#80000000"
                    Padding="30">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="25"
                        MinWidth="360"
                        MaxWidth="420"
                        BorderBrush="#1E3A8A"
                        BorderThickness="1.5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0"
                                   Text="Modificar Ticket"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#1E3A8A"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,15"/>

                        <StackPanel Grid.Row="1" Margin="0,0,0,12">
                            <TextBlock Text="Matrícula"
                                       FontSize="13"
                                       Foreground="#374151"/>
                            <TextBox x:Name="TxtEditarMatricula"
                                     Height="44"
                                     FontSize="20"
                                     FontWeight="Bold"
                                     CharacterCasing="Upper"
                                     HorizontalContentAlignment="Center"
                                     VerticalContentAlignment="Center"
                                     BorderBrush="#3B82F6"
                                     BorderThickness="1.5"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Margin="0,0,0,12">
                            <TextBlock Text="Descripción"
                                       FontSize="13"
                                       Foreground="#374151"/>
                            <TextBox x:Name="TxtEditarDescripcion"
                                     Height="36"
                                     FontSize="13"
                                     BorderBrush="#D1D5DB"
                                     BorderThickness="1"/>
                        </StackPanel>

                        <StackPanel Grid.Row="3" Margin="0,0,0,16">
                            <TextBlock Text="Categoría"
                                       FontSize="13"
                                       Foreground="#374151"/>
                            <ComboBox x:Name="CmbEditarCategoria"
                                      Height="38"
                                      FontSize="13"
                                      BorderBrush="#3B82F6"
                                      BorderThickness="1"
                                      VerticalContentAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="4"
                                   Orientation="Horizontal"
                                   HorizontalAlignment="Center"
                                   Margin="0,10,0,0">
                            <Button Content="Cancelar"
                                    Width="120"
                                    Height="38"
                                    Background="Transparent"
                                    BorderBrush="#1E3A8A"
                                    Foreground="#1E3A8A"
                                    BorderThickness="1"
                                    Margin="0,0,10,0"
                                    Click="BtnCancelarEdicionTicket_Click"/>
                            <Button Content="Modificar Ticket"
                                    Width="150"
                                    Height="38"
                                    Background="#1E3A8A"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="BtnGuardarEdicionTicket_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Border>
        </Popup>

        <!-- Popup cancelar ticket -->
        <Popup x:Name="PopupCancelarTicket"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               Placement="Center">
            <Border Background="Transparent"
                    Padding="30">
                <Border Background="White"
                        CornerRadius="8"
                        Padding="24"
                        MinWidth="420"
                        MaxWidth="460"
                        BorderBrush="#1E3A8A"
                        BorderThickness="1.5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="✕"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    FontSize="14"
                                    Foreground="#1E3A8A"
                                    Click="BtnCerrarPopupCancelar_Click"/>
                        </StackPanel>

                        <TextBlock x:Name="TxtCancelarTitulo"
                                   Grid.Row="1"
                                   Text="Cancelación del Ticket"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="#1E3A8A"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,12"/>

                        <TextBlock Grid.Row="2"
                                   Text="Escriba detalladamente los motivos por el cual realiza la cancelación del ticket."
                                   FontSize="12"
                                   Foreground="#374151"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>

                        <TextBox x:Name="TxtMotivoCancelacion"
                                 Grid.Row="3"
                                 Height="120"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 BorderBrush="#3B82F6"
                                 BorderThickness="1"
                                 FontSize="13"
                                 Margin="0,0,0,12"/>

                        <TextBlock Grid.Row="4"
                                   Text="Importante: Cancelar el ticket implica eliminarlo por completo, incluso los movimientos de caja relacionados al ticket, quedará solo un registro del ticket cancelado y su motivo. Esta acción no puede deshacerse!"
                                   FontSize="12"
                                   Foreground="#B91C1C"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>

                        <Button Grid.Row="5"
                                Content="Cancelar Ticket"
                                Height="42"
                                Background="#1E3A8A"
                                Foreground="White"
                                BorderThickness="0"
                                Click="BtnConfirmarCancelacion_Click"/>
                    </Grid>
                </Border>
            </Border>
        </Popup>
    </Grid>
</Window>
